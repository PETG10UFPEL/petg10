try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="42dd9c1d-c413-444b-bdbd-7dee7f825998",e._sentryDebugIdIdentifier="sentry-dbid-42dd9c1d-c413-444b-bdbd-7dee7f825998")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41743],{0x14a6d5f1:(e,t,a)=>{a.d(t,{A9:()=>p,Wq:()=>m,fC:()=>f,qv:()=>y});var l=a(0x12c9046cd),n=a(0x20b939f38),i=a(0x49fac030),r=a(0xac309a83),s=a(0x156c4e43b);let o={image_in:!0,pdf_in:!1},d=s.Ik({model_id:s.Yj(),minimum_tier:s.k5(["free","pro","max"])}),u=s.YO(d),c=s.Ik({models:s.YO(d).optional()}),f=e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,n.Hb)(),{data:r,isLoading:s,isPlaceholderData:d}=(0,l.Sk)("/api/organizations/".concat(a,"/model_configs/").concat(e),{queryKey:[i.yVY,a,e],enabled:!!t,staleTime:3e5,meta:{noToast:!0}});return{isLoading:s,modelConfig:!d&&r||o}},g=[],p=()=>{var e;let{activeOrganization:t}=(0,n.YL)(),a=null!=(e=null==t?void 0:t.claude_ai_bootstrap_models_config)?e:g,l=a.filter(e=>!e.inactive),i=l.filter(e=>!e.overflow),r=l.filter(e=>e.overflow);return{allModelOptions:a,activeModelOptions:l,mainModels:i,overflowModels:r}},m=()=>{let{allModelOptions:e}=p();return(t,a)=>{let l=e.find(e=>e.model===t);if(!l)return!1;let n=null==l?void 0:l.capabilities;return!n||!1!==n[a]}},y=()=>{var e;let t=(0,n.h0)(),a=(0,r.GZ)("frontend","claude_ai_available_models",{models:[]},c),l=(0,r.T9)("claude_ai_available_models","models",[],u);if(t)return[];let i=null!=(e=null==a?void 0:a.models)?e:[];return(i.length>0?i:l).filter(e=>"free"===e.minimum_tier).map(e=>e.model_id)}},0x87b1176c:(e,t,a)=>{a.d(t,{Bg:()=>d,fR:()=>f,iV:()=>c,ih:()=>u,nI:()=>g});var l=a(0x12c9046cd),n=a(0x20b939f38),i=a(0x10728a05e),r=a(0x49fac030),s=a(0x1b813d90),o=a(0x17e725145);let d=()=>{let{account:e,activeOrganization:t}=(0,n.YL)(),a=null==e?void 0:e.uuid,i=null==t?void 0:t.uuid,d=(0,o.useQueryClient)();return(0,l.L2)("/api/organizations/".concat(i,"/sync/mcp/drive/ingest"),"POST",{onSuccess:()=>{setTimeout(()=>{d.invalidateQueries({queryKey:[r.hxI,{orgUuid:i,accountUuid:a,syncSourceType:s.v8.GDRIVE}]})},300)}})},u=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid,{addError:a}=(0,i.Yf)(),d=(0,o.useQueryClient)();return(0,l.L2)("/api/organizations/".concat(t,"/sync/ingestion/gdrive/clean_up"),"POST",{onSuccess:()=>{d.invalidateQueries({queryKey:[r.hxI,{orgUuid:t,syncSourceType:s.v8.GDRIVE}]})},onError:e=>{a(e.message,{error:e,errorContext:{tags:{source:"knowledge_cleanup_ingestion"}}})}})},c=e=>{let{activeOrganization:t}=(0,n.YL)(),a=null==t?void 0:t.uuid,i=(0,o.useQueryClient)();return(0,l.L2)("/api/organizations/".concat(a,"/projects/").concat(e,"/kb/resync"),"POST",{enabled:!!e,meta:{noToast:!0},onSuccess:t=>{"done"===t.status&&i.invalidateQueries({queryKey:[r.qzW,{orgUuid:a,projectUuid:e}]}),e&&t.gdrive_resource_backfill_triggered&&i.invalidateQueries({queryKey:[r.LVb,{orgUuid:a,projectUuid:e}]})}})},f=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{activeOrganization:a}=(0,n.YL)(),i=null==a?void 0:a.uuid;return(0,l.Sk)("/api/organizations/".concat(i,"/projects/").concat(e,"/kb/stats"),{queryKey:[r.qzW,{orgUuid:i,projectUuid:e}],enabled:!!e&&t})},g=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid;return(0,l.L2)("/api/organizations/".concat(t,"/conversation/backfill"),"POST",{})}},0xed690259:(e,t,a)=>{a.d(t,{Dm:()=>c,Gx:()=>f,Sv:()=>u});var l=a(0x1139502dd),n=a(0x15eb29f79),i=a(0x1ac4f341b),r=a(0x9f369389),s=a(0x1a3383306),o=a(0xe670e093);let d=new Set(l.gC);function u(){var e,t;return!!(null==(t=window.claudeAppSettings)||null==(e=t.filePickers)?void 0:e.getPathForFile)}function c(e){if(!u())return null;try{return window.claudeAppSettings.filePickers.getPathForFile(e)}catch(e){return null}}async function f(e,t){let a=[],l=[],u=[];for(let g of e){var f;let e,p=null!=(f=null==t?void 0:t.get(g))?f:c(g),m=d.has(g.type),y=g.type;if(m||!p){if(g.size>0x3200000){u.push(g);continue}let t=m?await (0,i.R)(g):g;y=t.type,e=await (0,n.bB)(t)}if(!p&&(null===r.Q2||void 0===r.Q2?void 0:r.Q2.savePastedFile)&&e){let t=await r.Q2.savePastedFile(e,y,g.name);t.path&&(p=t.path)}if(p)if(m&&e)l.push({type:"image",source:{type:"base64",media_type:y,data:e}});else{let e={file_kind:s.Mr.Blob,file_uuid:(0,o.b)(),file_name:g.name,created_at:new Date().toISOString(),localPath:p,path:p};a.push(e)}else u.push(g)}return{files:a,imageBlocks:l,failedFiles:u}}},0x101fa1001:(e,t,a)=>{a.d(t,{Si:()=>Y,i1:()=>D,vV:()=>I,fU:()=>E});var l=a(0x22102fd88),n=a(0x524626b5),i=a(0x1139502dd),r=a(0x11bdd7e02),s=a(0x20bb4cd39),o=a(0x1cae89638),d=a(0xed690259),u=a(0x226530adf),c=a(0x14a6d5f1),f=a(0xfd34bc37),g=a(0xf32c56dd),p=a(0x12c9046cd),m=a(0x20b939f38),y=a(0x10728a05e),h=a(0xb3796c53),x=a(0x1016c6ed2),b=a(0x20e00cddd),v=a(0x1a3383306),_=a(0x49fac030),w=a(0xac309a83),M=a(0x214c6246e),A=a(0x20b796df9),C=a(0x17e725145),P=a(0x1a1f6dda6),k=a(0xfc89b4a4),j=a(0x38e6572),z=a(0x1ab0d1ca1),T=a(0x5267d157),S=a(0x15b1a866a),L=a(0x25d59887);let F=[{matcher:e=>e.message.toLowerCase().includes("failed to fetch")||e.message.toLowerCase().includes("load failed")||e.message.toLowerCase().includes("networkerror"),createMessage:()=>(0,l.jsx)(j.A,{defaultMessage:"Upload failed due to a network issue. Check your internet connection and try again.",id:"1bxKaj0pKU"})},{matcher:e=>e.message.includes("password protected")||e.message.includes("document_password_protected"),createMessage:()=>(0,l.jsx)(j.A,{defaultMessage:"The document you uploaded is password protected. Please remove the password and try again.",id:"DHwwKwuaCR"})},{matcher:e=>e.message.includes("https://docs.claude.com/en/docs/build-with-claude/files#error-handling"),createMessage:()=>(0,l.jsx)(j.A,{defaultMessage:'The title of the document you uploaded is too long, or includes forbidden characters (<, >, :, ", |, ?, *, \\, /, or unicode characters 0-31)',id:"NdLqN5Z3bE"})},{matcher:e=>e.message.includes("Code execution and file creation"),extractor:e=>[...new Set(e.map(e=>(0,n.QC)(e.file.name)))],createMessage:e=>(0,l.jsx)(j.A,{defaultMessage:"Files of the following {count, plural, one {format} other {formats}} require 'Code execution and file creation'. Go to Settings > Capabilities to enable: {formats}",id:"o/NOFEuWmE",values:{count:e.length,formats:(0,l.jsx)(S.dT,{type:"conjunction",value:e})}})},{matcher:e=>e.message.includes("not supported"),extractor:e=>[...new Set(e.map(e=>(0,n.QC)(e.file.name)))],createMessage:e=>(0,l.jsx)(j.A,{defaultMessage:"Files of the following {count, plural, one {format is} other {formats are}} not supported: {formats}",id:"9JcWWPAZoB",values:{count:e.length,formats:(0,l.jsx)(S.dT,{type:"conjunction",value:e})}})},{matcher:e=>e.message.includes("exceeds maximum size")||e.message.includes("File too large"),extractor:e=>e.map(e=>({file_type:e.file.type,file_size:e.file.size})),createMessage:()=>{let e=Math.floor(i.gZ/1048576);return(0,l.jsx)(j.A,{defaultMessage:"You may not upload files larger than {sizeLimit}mb.",id:"nW3gZD88Va",values:{sizeLimit:e}})},trackAnalytics:(e,t)=>{e.track({event_key:"file_upload_too_large",large_files:t})}}];function Y(e){var t;let{syncSourceCount:a,files:r,setFiles:o,numExistingConversationFiles:f,attachments:g,setAttachments:p,numExistingConversationAttachments:m,detectSameAttachment:x,selectedModel:b,blobFileUploadsEnabled:v,conversationUuid:_,wiggleEnabled:w,isLocalAgentMode:C=!1,onImageBlocksReceived:P,onFolderDropped:T,enableEncodingPicker:S=!1}=e,{addError:L}=(0,y.Yf)(),F=(0,u.Z3)(null),[Y,E]=(0,k.useState)(null),U=(0,k.useRef)(Y);U.current=Y;let Q=S&&null!==Y&&null!=(t=g.find(e=>e.encodingPendingId===Y))?t:null,K=(0,k.useCallback)(e=>{S&&null!==Y&&(p(t=>t.map(t=>t.encodingPendingId===Y?{...t,extracted_content:(0,s.Og)(e),encodingPending:void 0,encodingPendingId:void 0}:t)),E(null))},[S,Y,p]),G=(0,k.useCallback)(()=>{S&&E(null)},[S]),O=(0,k.useCallback)(e=>{},[]),B=(0,k.useCallback)(async(e,t)=>{if(x&&e.find(e=>x(e.extracted_content)))return void L((0,l.jsx)(j.A,{defaultMessage:"The same attachment was already added earlier. Claude sees the full conversation when replying, so there's no need to re-upload.",id:"KSgHlAYtgG"}));p(t=>[...t,...e]),o(e=>[...e,...t]),await Promise.resolve()},[x,L,p,o]),N=(0,k.useCallback)(e=>{1===e&&null===U.current&&p(e=>{let t=[...e].reverse().find(e=>!!e.encodingPending);return(null==t?void 0:t.encodingPendingId)&&E(t.encodingPendingId),e})},[p]);return[...function(e){let{syncSourceCount:t,onUploadComplete:a,existingAttachments:r,existingFiles:s,numExistingConversationAttachments:o,numExistingConversationFiles:u,selectedModel:f,blobFileUploadsEnabled:g,conversationUuid:p,wiggleEnabled:m,isLocalAgentMode:y=!1,onImageBlocksReceived:x,onFolderDropped:b,onEncodingPending:v,enableEncodingPicker:_=!1}=e,w=(0,z.A)(),{modelConfig:C}=(0,c.fC)(f),P=C.image_in,[T,S,L,F]=function(e){let{syncSourceCount:t,onUploadComplete:a,existingAttachments:n,existingFiles:r,numExistingConversationFiles:s,selectedModel:o,blobFileUploadsEnabled:d,conversationUuid:u,wiggleEnabled:f,isLocalAgentMode:g=!1,onImageBlocksReceived:p,onEncodingPending:m,enableEncodingPicker:y=!1}=e,{modelConfig:h}=(0,c.fC)(o),x=h.image_in,b=D()&&h.pdf_in,{isUploading:v,setIsUploading:_,handleError:w,handleUpload:M}=I({imagesEnabled:x,blobFileUploadsEnabled:d,onUploadComplete:a,rasterizePdfUploadsEnabled:b,conversationUuid:u,wiggleEnabled:f,isLocalAgentMode:g,onImageBlocksReceived:p,onEncodingPending:m,enableEncodingPicker:y}),A=(0,k.useCallback)(e=>{let{newUploads:a=[],numNewPotentialAttachments:o=0,showError:u=!0}=e;if(o+a.length+(n.length+r.length+t)>i.XA.maxTotalUploadsPerMessage)return u&&w((0,l.jsx)(j.A,{defaultMessage:"You can add at most {count, plural, one {# attachment} other {# attachments}} to a message. Please select fewer attachments.",id:"qxV00r12ob",values:{count:i.XA.maxTotalUploadsPerMessage}})),!1;let c=s||0,{messageFileCount:f}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=0,l=0,n=0;for(let r of e){let{willBecomeMessageFile:e,category:s}=function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=(null==(t=e.name.split(".").pop())?void 0:t.toLowerCase())||"";return i.h8.includes(l)?{category:"image",willBecomeMessageFile:!!a.imagesEnabled}:i.Ap.includes(l)?{category:"pdf",willBecomeMessageFile:!!a.rasterizePdfUploadsEnabled,requiresFeatureGate:"janus_claude-ai"}:i.PC.includes(l)?{category:"out-of-context",willBecomeMessageFile:!!a.blobFileUploadsEnabled,requiresFeatureGate:"ooc_attachments"}:i.BA.includes(l)?{category:"text",willBecomeMessageFile:!1}:i.pH.includes(l)?{category:"document",willBecomeMessageFile:!1}:{category:"unsupported",willBecomeMessageFile:!1}}(r,t);"unsupported"===s?n++:e?a++:l++}return{messageFileCount:a,messageAttachmentCount:l,unsupportedCount:n}}(a,{blobFileUploadsEnabled:d,imagesEnabled:x,rasterizePdfUploadsEnabled:b});if(c+f>i.XA.maxFilesPerConversation){var g;return u&&w((g=i.XA.maxFilesPerConversation,(0,l.jsx)(j.A,{defaultMessage:"You can add at most {count, plural, one {# file} other {# files}} to a chat. {suggestion}",id:"QyrCxYs5Jy",values:{count:g,suggestion:c<g?(0,l.jsx)(j.A,{defaultMessage:"Please select fewer files.",id:"a6KVizNPLe"}):(0,l.jsx)(j.A,{defaultMessage:"Please consider starting a new chat.",id:"oN0R8lZNm6"})}}))),!1}return!0},[n,r,t,w,d,s,x,b]);return[v,_,A,(0,k.useCallback)(async(e,t)=>{A({newUploads:e})&&await M(e,void 0,t)},[M,A])]}({syncSourceCount:t,onUploadComplete:a,existingFiles:s,existingAttachments:r,numExistingConversationFiles:u,numExistingConversationAttachments:o,selectedModel:f,blobFileUploadsEnabled:g,conversationUuid:p,wiggleEnabled:m,isLocalAgentMode:y,onImageBlocksReceived:x,onEncodingPending:v,enableEncodingPicker:_}),Y=function(e){let{handleUpload:t,isLocalAgentMode:a=!1,onFolderDropped:l}=e,n=(0,k.useRef)({ready:0,total:0}),i=(0,k.useCallback)(()=>{n.current={ready:0,total:0}},[]),r=(0,k.useRef)(new Map),s=(0,k.useCallback)(e=>{n.current.ready+=1,n.current.total===n.current.ready&&t(e,r.current.size>0?r.current:void 0)},[t]),o=(0,k.useCallback)((e,t,l)=>{let i=e.length;for(let d=0;d<i;d++){let i=e[d];i.isFile?(n.current.total+=1,i.file(e=>{if(a&&l&&i.fullPath){let t=i.fullPath.split("/")[1],a=t?l.get(t):void 0;if(a){let t=i.fullPath.substring(a.fullPath.length);r.current.set(e,a.nativePath+t)}}t.push(e),s(t)})):i.isDirectory&&i.createReader().readEntries(e=>{o(e,t,l)})}},[s,a]);return(0,k.useCallback)(e=>{var t,n,s;let u;e.preventDefault(),i(),r.current=new Map;let c=null==(t=e.dataTransfer)?void 0:t.items;if(!c)return;if(a&&l&&(null==(n=e.dataTransfer)?void 0:n.files)){let t=[];for(let a=0;a<c.length;a++){let l=c[a].webkitGetAsEntry();if(null==l?void 0:l.isDirectory){let l=e.dataTransfer.files[a];if(l){let e=(0,d.Dm)(l);e&&t.push(e)}}}if(t.length>0)return void l(t)}a&&(null==(s=e.dataTransfer)?void 0:s.files)&&(u=new Map);let f=[];for(let t=0;t<c.length;t++){let a=c[t].webkitGetAsEntry();if(a&&(f.push(a),u)){let l=e.dataTransfer.files[t];if(l){let e=(0,d.Dm)(l);e&&u.set(a.name,{nativePath:e,fullPath:a.fullPath})}}}o(f,[],u)},[o,i,a,l])}({handleUpload:F,isLocalAgentMode:y,onFolderDropped:b}),E=(0,k.useCallback)(async e=>{let t=Array.from(e).map(e=>new File([e],"".concat(Date.now(),"_").concat(e.name),{type:e.type,lastModified:e.lastModified}));await F(t)},[F]),U=(0,k.useCallback)(async e=>{let t=e.target.files;t&&await F(Array.from(t)),e.target.value=""},[F]),Q=Math.floor(i.XA.maxFileSize/1048576),K=P?(0,l.jsx)(j.A,{defaultMessage:"Upload docs or images to Claude\\n(Max {maxUploads}, {maxSize}mb each)",id:"TGYeob9u0b",values:{maxUploads:i.XA.maxTotalUploadsPerMessage,maxSize:Q}}):(0,l.jsx)(j.A,{defaultMessage:"Add content ({maxUploads} max, {maxSize}mb each)\\nAccepts pdf, txt, csv, etc.",id:"rW/kw78ou7",values:{maxUploads:i.XA.maxTotalUploadsPerMessage,maxSize:Q}}),G=(0,k.useCallback)(e=>{U(e)},[U]),O=(0,k.useMemo)(()=>({type:"file",accept:m?"":(0,n.cm)({imagesEnabled:P,outOfContextFilesEnabled:g}).join(","),onChange:G,multiple:!0,"aria-label":w.formatMessage({defaultMessage:"Upload files",id:"2jjdVzJX0c"})}),[P,g,m,G,w]);return[T,S,L,Y,E,F,(0,l.jsx)(h.Tooltip,{className:"text-center",tooltipContent:K,children:(0,l.jsxs)(q,{children:[(0,l.jsx)("input",{"data-testid":"file-upload",className:"absolute inset-0 -z-10 overflow-hidden rounded-xl opacity-0",...O}),T?(0,l.jsx)(M.N,{className:"animate-spin",size:18}):(0,l.jsx)(A.x,{size:18,weight:"light"})]})},"upload-tooltip"),O]}({syncSourceCount:a,onUploadComplete:B,existingAttachments:g,existingFiles:r,numExistingConversationAttachments:m,numExistingConversationFiles:f,selectedModel:null!=b?b:F,blobFileUploadsEnabled:v,conversationUuid:_,wiggleEnabled:w,isLocalAgentMode:C,onImageBlocksReceived:P,onFolderDropped:T,onEncodingPending:S?N:void 0,enableEncodingPicker:S}),Q,K,G,S?E:O]}let E=()=>{let e=(0,p.mn)(),t=(0,C.useQueryClient)();return async(a,l,n)=>{let i=new FormData;i.append("file",a);let r=n?"/api/organizations/".concat(l,"/projects/").concat(n,"/upload"):"/api/".concat(l,"/upload"),s=await e(r,{method:"POST",body:i}),o=await s.json();if(s.ok)return n&&t.invalidateQueries({queryKey:[_.qzW,{orgUuid:l,projectUuid:n}]}),o;throw(0,x.a5)({status:s.status,response:o,fallbackMessage:"File upload failed",headers:s.headers,endpoint:r,method:"POST"})}},I=e=>{var t;let{imagesEnabled:a,blobFileUploadsEnabled:n,rasterizePdfUploadsEnabled:u,onUploadComplete:c,onError:p,projectUuid:h,conversationUuid:_,wiggleEnabled:w,isLocalAgentMode:M=!1,onImageBlocksReceived:A,onEncodingPending:C,enableEncodingPicker:P=!1}=e,{activeOrganization:z}=(0,m.YL)(),S=null!=(t=null==z?void 0:z.uuid)?t:"",[Y]=(0,f.d)(),E=_||Y,[I,q]=(0,k.useState)(!1),{addError:D}=(0,y.Yf)(),U=(()=>{let{addError:e}=(0,y.Yf)();return(0,k.useCallback)((t,a)=>{if(t instanceof x.LG){if("rate_limit_error"===t.type)return void e((0,l.jsxs)("p",{children:[(0,l.jsx)(j.A,{defaultMessage:"Youâ€™ve reached your limit for {resourceType} uploads. Please try again later.",id:"M88GeEDB7r",values:{resourceType:a}}),(0,l.jsx)(L.W,{})]}),{error:t});if("document_password_protected"===t.errorCode)return void e((0,l.jsx)("p",{children:(0,l.jsx)(j.A,{defaultMessage:"The document you uploaded is password protected. Please remove the password and try again.",id:"DHwwKwuaCR"})}),{error:t})}if(t instanceof x.LG&&"Image is too large"===t.message)return void e((0,l.jsx)("p",{children:(0,l.jsx)(j.A,{defaultMessage:"Image is too large. <link>Learn more</link>",id:"SFbt+MAvby",values:{link:e=>(0,l.jsx)("a",{href:"https://support.claude.com/en/articles/8241126-uploading-files-to-claude",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-accent-main-100",children:e})}})}),{error:t});e((0,l.jsx)("p",{children:(0,l.jsx)(j.A,{defaultMessage:"Your {resourceType} upload failed. Please try again.",id:"ymWsV10Pz1",values:{resourceType:a}})}),{error:t})},[e])})(),Q=(0,k.useCallback)(e=>{q(!1),D(e,{errorContext:{tags:{source:"file_upload"}}}),p&&p()},[D,p,q]),K=(0,g.st)(),G=(0,k.useCallback)(async(e,t,f)=>{q(!0);try{if(M){if(!(0,d.Sv)())return void Q("File upload is only available in Claude for Desktop.");let{files:t,imageBlocks:a,failedFiles:l}=await (0,d.Gx)(e,f);if(l.length>0){let e=l.map(e=>e.name).join(", ");Q("Could not get file paths for: ".concat(e));return}q(!1),t.length>0&&await c([],t),a.length>0&&A&&A(a);return}if(!S)throw Error("Organization not loaded. Please try again.");let g=(0,r.e)(),p=(0,r.O)(e),m=function(e){let{orgUuid:t,projectUuid:a,conversationUuid:l,imagesEnabled:n,rasterizePdfUploadsEnabled:r,blobFileUploadsEnabled:s,wiggleEnabled:o}=e;return{orgUuid:t,projectUuid:a,conversationUuid:l,modelConfig:{image_in:n,pdf_in:r},featureGates:{janus_claude_ai:r,ooc_attachments:s,use_canvas_resize:!0,wiggleEnabled:o},limits:i.XA}}({orgUuid:S,projectUuid:h,conversationUuid:E,imagesEnabled:a,rasterizePdfUploadsEnabled:u,blobFileUploadsEnabled:n,wiggleEnabled:w}),y=await g.processFiles(p,m),{attachments:x,files:_,errors:k}=function(e){let t=[],a=[],l=[];for(let l of e.successful){let e=l.data;"attachment"===l.type?"extracted_content"in e&&t.push(e):"file_kind"in e&&a.push(e)}for(let t of e.failed)l.push({file:t.file,error:t.error});return{attachments:t,files:a,errors:l}}(y),z=P?k.filter(e=>e.error instanceof o.Ug):[],L=P?k.filter(e=>!(e.error instanceof o.Ug)):k,Y=z.map(e=>({file_name:(0,s.nG)(e.file),file_type:e.file.type,file_size:e.file.size,extracted_content:"",origin:v.R9.UserUpload,kind:v.XA.File,encodingPending:{buffer:e.error.buffer},encodingPendingId:crypto.randomUUID(),...e.error.wigglePath?{path:e.error.wigglePath}:{}})),I=[...x,...Y];if(L.length>0&&(!function(e,t,a){if(0!==e.length){for(let l of F){let n=e.filter(e=>l.matcher(e.error));if(n.length>0){let e=l.extractor?l.extractor(n):n;return l.trackAnalytics&&l.trackAnalytics(a,e),t(l.createMessage(e)),!0}}for(let a of e)if(a.error instanceof T.o)return t((0,T.B)(a.error)),!0;e.forEach(e=>t(e.error.message))}}(L,Q,K),0===I.length&&0===_.length))return;let D=function(e,t,a){if(void 0===t||0===e.length)return e;let n=0,i=[];for(let r of e){if((n+=new Blob([r.extracted_content]).size/b.t2)>t)return a((0,l.jsx)(j.A,{defaultMessage:"Failed to upload file {filename}. Project knowledge exceeds maximum. Remove files to continue.",id:"MbvF6K3PJd",values:{filename:r.file_name}})),[];i.push(r)}return i}(x,t,Q);if(0===D.length&&x.length>0&&0===Y.length&&0===_.length)return;let U=[...D,...Y];q(!1),(U.length>0||_.length>0)&&await c(U,_),Y.length>0&&C&&C(Y.length)}catch(t){if(function(e,t){return e instanceof Error?(e.isRateLimit?t((0,l.jsx)(j.A,{defaultMessage:"Too many file upload attempts. Please wait and try again later.",id:"h/6cMHSn1V"})):413===e.statusCode||"file_too_large"===e.errorType?t((0,l.jsx)(j.A,{defaultMessage:"Uploaded file is too large. Try uploading a smaller part of the document, or copy/pasting an excerpt from the file.",id:"/mCoauj3Ws"})):"extraction_failed"===e.errorType?t((0,l.jsx)(j.A,{defaultMessage:"The file format may not be supported or the file may be corrupted.",id:"CvPTXPZIw8"})):t((0,l.jsx)(j.A,{defaultMessage:"One or more file uploads have failed. Please try again.",id:"FIwcYDeyIC"})),!0):(t((0,l.jsx)(j.A,{defaultMessage:"One or more file uploads have failed. Please try again.",id:"FIwcYDeyIC"})),!0)}(t,Q))return;let e="file";t instanceof Error&&t.message.includes("image")&&(e="image"),U(t,e)}finally{q(!1)}},[n,c,a,E,Q,U,S,K,u,h,w,M,A,C,P]);return{isUploading:I,setIsUploading:q,handleError:Q,handleUpload:G}};function q(e){let{className:t,...a}=e;return(0,l.jsx)("label",{className:(0,P.A)("relative grid place-content-center aspect-square rounded-xl cursor-pointer transition [fieldset:not(:disabled)_&]:hover:bg-bg-400 [fieldset:disabled_&]:opacity-50 [fieldset:disabled_&]:pointer-events-none focus-within:ring inline-flex items-center justify-center shrink-0 ring-offset-2 ring-offset-bg-300 ring-accent-main-100 focus-visible:outline-none focus-visible:ring-1 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none disabled:drop-shadow-none bg-[radial-gradient(ellipse,_var(--tw-gradient-stops))] from-bg-500/10 from-50% to-bg-500/30 border-0.5 border-border-400 font-medium font-ui text-text-100/90 transition-colors active:bg-bg-500/50 hover:text-text-000 hover:bg-bg-500/60",t),...a})}let D=()=>(0,w.fS)("janus_claude-ai")},0x15eb29f79:(e,t,a)=>{function l(e){return new Promise((t,a)=>{let l=new FileReader;l.onload=()=>{t(l.result.split(",")[1])},l.onerror=()=>a(l.error),l.readAsDataURL(e)})}function n(e){let t=e.clipboardData.items,a=[];for(let e=0;e<t.length;e++){let l=t[e];if(l.type.startsWith("image/")){let e=l.getAsFile();e&&a.push(e)}}return a}a.d(t,{bB:()=>l,gt:()=>n})},0x1bd42f6d2:(e,t,a)=>{a.d(t,{CO:()=>f,M3:()=>d,bG:()=>u,ks:()=>p,pz:()=>o,z_:()=>c});var l=a(0x12c9046cd),n=a(0x20b939f38),i=a(0x49fac030),r=a(0x17e725145),s=a(0x18175ce17);let o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:a}=(0,n.YL)(),i=null==a?void 0:a.uuid,r=g(),o=(0,s.eL)();return(0,l.L2)(()=>"/api/organizations/".concat(i,"/projects/").concat(e,"/syncs"),"POST",{enabled:!!(a&&e),...t,onSuccess:function(){for(var a,l=arguments.length,n=Array(l),i=0;i<l;i++)n[i]=arguments[i];r(e),null==(a=t.onSuccess)||a.call(t,...n)},onError:function(){for(var e,a=arguments.length,l=Array(a),n=0;n<a;n++)l[n]=arguments[n];null==(e=t.onError)||e.call(t,...l);let[i,r]=l;o(i,r)}})},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:a}=(0,n.YL)(),i=null==a?void 0:a.uuid,r=g();return(0,l.L2)(()=>"/api/organizations/".concat(i,"/projects/").concat(e,"/syncs"),"PUT",{enabled:!!(a&&e),...t,onSuccess:function(){for(var a,l=arguments.length,n=Array(l),i=0;i<l;i++)n[i]=arguments[i];r(e),null==(a=t.onSuccess)||a.call(t,...n)}})},u=e=>{let{activeOrganization:t}=(0,n.YL)(),a=null==t?void 0:t.uuid,r=g();return(0,l.Qv)(t=>"/api/organizations/".concat(a,"/projects/").concat(e,"/syncs/").concat(t),"DELETE",(e,t)=>t?t.filter(t=>t.uuid!==e):t,{queryKey:[i.LVb,{orgUuid:a,projectUuid:e}],enabled:!!t,onSuccess:()=>{r(e)}})},c=e=>{let{activeOrganization:t}=(0,n.YL)(),a=null==t?void 0:t.uuid,r=g();return(0,l.Qv)(()=>"/api/organizations/".concat(a,"/projects/").concat(e,"/syncs/delete_many"),"POST",(e,t)=>t?t.filter(t=>!e.sync_source_uuids.includes(t.uuid)):t,{queryKey:[i.LVb,{orgUuid:a,projectUuid:e}],enabled:!!t,onSuccess:()=>{r(e)}})},f=function(e,t){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{activeOrganization:o}=(0,n.YL)(),d=null==o?void 0:o.uuid,u=(0,r.useQueryClient)(),c=!!(o&&e&&a),{data:f,isLoading:g}=(0,l.Sk)("/api/organizations/".concat(d,"/projects/").concat(e,"/syncs?calculate_size=").concat(null!=t&&t),{queryKey:[i.LVb,{orgUuid:d,projectUuid:e,calculateSize:t}],enabled:c,refetchInterval:e=>{var t;return(null==(t=e.state.data)?void 0:t.some(s.z3))?5e3:3e5},structuralSharing:(t,a)=>{let l=Array.isArray(t)&&t.some(s.z3),n=Array.isArray(a)&&a.some(s.z3);return l&&!n&&u.invalidateQueries({queryKey:[i.qzW,{orgUuid:d,projectUuid:e}]}),a}});return{data:Array.isArray(f)?f:void 0,isLoading:!!c&&g}},g=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid,a=(0,r.useQueryClient)();return e=>{a.invalidateQueries({queryKey:[i.LVb,{orgUuid:t,projectUuid:e}]}),a.invalidateQueries({queryKey:[i._GT,{orgUuid:t,projectUuid:e}]}),a.invalidateQueries({queryKey:[i.qzW,{orgUuid:t,projectUuid:e}]})}},p=e=>{let{data:t}=f(e);return!!(null==t?void 0:t.some(s.z3))}},0x1e3604791:(e,t,a)=>{a.d(t,{N:()=>n});var l=a(0xac309a83);function n(e){let t=(0,l.GZ)("frontend","analysis_tool_experiment_enabled",!1,l.Km);if((0,l.fS)("rely_on_analysis_flag")){var a;return{value:null==(a=null==e?void 0:e.enabled_artifacts_attachments)||a,source:"flag"}}return{value:(null==e?void 0:e.enabled_artifacts_attachments)||t,source:"experiment"}}},0x2466a442d:(e,t,a)=>{a.d(t,{c:()=>s});var l=a(0x1e3604791),n=a(0x20b939f38),i=a(0x371cc700),r=a(0x13279c600);function s(){var e,t;let{account:a}=(0,n.YL)(),s=(0,i.B)(),o=null!=(t=null!=s?s:null==a?void 0:a.settings)?t:{},{value:d}=(0,l.N)(o),u=(0,r.u9)();return!!u.isAvailable||"disabled_by_user"===u.status&&null!=a&&null!=(e=a.settings)&&!!e.enabled_monkeys_in_a_barrel||d}}}]);