try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="84a2a75b-f4dc-4bb2-ac7f-644fbf6f4bbd",e._sentryDebugIdIdentifier="sentry-dbid-84a2a75b-f4dc-4bb2-ac7f-644fbf6f4bbd")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[17421],{0x20c062c6:(e,t,n)=>{n.d(t,{$c:()=>c,B3:()=>p,Dc:()=>r,ED:()=>h,Q1:()=>v,QQ:()=>o,U4:()=>l,YX:()=>d,ZT:()=>u,eV:()=>s,is:()=>g,sS:()=>f});var i=n(0x394ef833);let s="mcp__elicit__present_options";function r(e){return"object"==typeof e&&null!==e&&"stream_event"===e.type&&"object"==typeof e.event&&null!==e.event}let a={buildPhase:"ready",isWorking:!1,previewPort:null,previewDevice:"desktop",previewError:null,streamEvents:[],streamEventsGeneration:0,elicitStreamActive:!1,isElicitStreaming:!1,streamingElicitOptions:[],isAnnotating:!1,annotationTarget:null,inspectorAvailable:!1},o=(0,i.v)((e,t)=>({...a,setBuildPhase:(n,i)=>{if(null==i?void 0:i.force)return void e({buildPhase:n});"deploying"!==t().buildPhase&&e({buildPhase:n})},setIsWorking:t=>e({isWorking:t}),setPreviewPort:t=>e({previewPort:t,previewError:null}),setPreviewDevice:t=>e({previewDevice:t}),setPreviewError:t=>e({previewError:t}),pushStreamEvent:t=>e(e=>e.elicitStreamActive?{streamEvents:[...e.streamEvents,t]}:e),clearStreamEvents:()=>e(e=>({streamEvents:[],streamEventsGeneration:e.streamEventsGeneration+1,elicitStreamActive:!1})),setElicitStreamActive:t=>e({elicitStreamActive:t}),setIsElicitStreaming:t=>e({isElicitStreaming:t}),setStreamingElicitOptions:t=>e({streamingElicitOptions:t}),clearStreamingElicit:()=>e({isElicitStreaming:!1,streamingElicitOptions:[]}),setIsAnnotating:t=>e({isAnnotating:t,annotationTarget:null}),setAnnotationTarget:t=>e({annotationTarget:t}),setInspectorAvailable:t=>e({inspectorAvailable:t}),reset:()=>e({...a,streamingElicitOptions:[]})})),u=()=>o(e=>e.buildPhase),l=()=>o(e=>e.previewDevice),c=()=>o(e=>e.previewPort),d=()=>o(e=>e.isElicitStreaming),f=()=>o(e=>e.streamingElicitOptions),g=()=>o(e=>e.isWorking),p=()=>o(e=>e.isAnnotating),h=()=>o(e=>e.annotationTarget),v=()=>o(e=>e.inspectorAvailable)},0x9fae1848:(e,t,n)=>{n.d(t,{_:()=>i});let i=(0,n(0x394ef833).v)(e=>({diffStats:{},setDiffStats:(t,n,i,s,r,a)=>{let o="".concat(t,":").concat(n,"/").concat(i,":").concat(s,":").concat(r);e(e=>{let t=e.diffStats[o];return t&&t.additions===a.additions&&t.deletions===a.deletions&&t.fileCount===a.fileCount&&t.hasChanges===a.hasChanges?e:{diffStats:{...e.diffStats,[o]:a}}})},clearSessionDiffStats:t=>{e(e=>{let n={};for(let[i,s]of Object.entries(e.diffStats))i.startsWith("".concat(t,":"))||(n[i]=s);return{diffStats:n}})}}))},0xbdad302d:(e,t,n)=>{n.d(t,{$D:()=>P,AC:()=>G,Bj:()=>I,Ey:()=>M,I5:()=>D,IZ:()=>N,Mf:()=>E,Mk:()=>X,Oo:()=>U,QW:()=>$,S1:()=>L,Tr:()=>k,XY:()=>T,_Y:()=>A,ct:()=>ee,f5:()=>K,fN:()=>q,gn:()=>C,hb:()=>j,jJ:()=>x,mL:()=>Y,oz:()=>O,pC:()=>et,r$:()=>eo,sn:()=>F,yp:()=>eu});var i=n(0xf32c56dd),s=n(0x12c9046cd),r=n(0x20b939f38),a=n(0x1016c6ed2),o=n(0x1aa5f8b46),u=n(0x49fac030),l=n(0xe670e093),c=n(0x22f291c2a),d=n(0x17e725145),f=n(0x20892a038),g=n(0xfc89b4a4),p=n(0x20c062c6),h=n(0x9fae1848),v=n(0x21687185c),m=n(0x17a32add1),y=n(0x11e751567),_=n(0x1343ac650),b=n(0x144bc081e),S=n(0xc5c5a42b),w=n(0xe6c3f31e);function E(e){return e.environment_id.endsWith("011111111111111111111112")}function k(e){return e?e.map(e=>"".concat(e.id,":").concat(e.session_status,":").concat(e.updated_at)).join("|"):""}function T(e){return"shared_session"===e.type}function x(e){if(T(e))return e.session;let{type:t,...n}=e;return{...n,type:"session"}}let P=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,i=(0,s.iC)("/v1/sessions",{queryKey:[u.Rvf,{orgUuid:n}],enabled:!!t&&e,staleTime:3e4,refetchOnWindowFocus:!1,pageParamName:"after_id",getNextPageParam:e=>e.has_more&&e.last_id?e.last_id:void 0,headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...n?{"x-organization-uuid":n}:{}},meta:{noToast:!0}}),{hasNextPage:a,isFetchingNextPage:o,fetchNextPage:l,isError:c}=i,d=i.data;(0,g.useEffect)(()=>{!a||o||c||l()},[a,o,l,c]);let f=i.refetch,p=(0,g.useCallback)(()=>{f({refetchPage:(e,t)=>0===t})},[f]);return{data:(0,g.useMemo)(()=>{var e,t,n,i;if(!(null==d?void 0:d.pages))return;let s=d.pages.flatMap(e=>e.data);return{data:s,has_more:!1,first_id:null!=(n=null==(e=s[0])?void 0:e.id)?n:null,last_id:null!=(i=null==(t=s[s.length-1])?void 0:t.id)?i:null}},[null==d?void 0:d.pages]),dataUpdatedAt:i.dataUpdatedAt,isLoading:i.isLoading,isError:i.isError,error:i.error,refetch:i.refetch,isFetching:i.isFetching,refetchFirstPage:p}};function M(e,t,n){if(0===t.length&&0===n.length)return e;let i="<uploaded_files>\n"+[...n.map(e=>"<file><file_path>".concat(e.path||e.file_name,"</file_path></file>")),...t.map(e=>{let t="<file_path>".concat(e.path||e.file_name,"</file_path>"),n=e.file_uuid?"<file_uuid>".concat(e.file_uuid,"</file_uuid>"):"";return"<file>".concat(t).concat(n,"</file>")})].join("\n")+"\n</uploaded_files>";return"".concat(i,"\n\n").concat(e)}function D(e,t,n){return{uuid:null!=n?n:(0,l.b)(),session_id:t,type:"user",parent_tool_use_id:null,message:{role:"user",content:e}}}let C=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{activeOrganization:n}=(0,r.YL)(),i=null==n?void 0:n.uuid;return(0,s.Sk)("/v1/sessions/".concat(e),{queryKey:[u.Exr,{orgUuid:i,sessionId:e}],enabled:!!n&&t&&!!e,meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...i?{"x-organization-uuid":i}:{}}})};function I(e){return{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr","x-organization-uuid":e}}function Q(e){var t;if(e.has_more)return e.last_id||(null==(t=e.data[e.data.length-1])?void 0:t.uuid)||void 0}let q=()=>{let e=(0,g.useRef)(null),t=(0,g.useRef)(new Map),{activeOrganization:n}=(0,r.YL)(),i=null==n?void 0:n.uuid,a=(0,d.useQueryClient)(),o=(0,s.mn)();return(0,g.useCallback)(n=>{if(!i||!n)return;let s=t.current.get(n);if(s&&Date.now()-s<1e3)return;if("undefined"!=typeof navigator&&"connection"in navigator&&navigator.connection){let e=navigator.connection;if("slow-2g"===e.effectiveType||"2g"===e.effectiveType||"3g"===e.effectiveType||void 0!==e.downlink&&e.downlink<1.5||e.saveData)return}let r=[u.riq,{orgUuid:i,sessionId:n}];if(a.isFetching({queryKey:r}))return;t.current.set(n,Date.now()),e.current&&e.current.abort(),e.current=new AbortController;let l=e.current,c=I(i),d=()=>{let e=[u.Exr,{orgUuid:i,sessionId:n}];a.prefetchQuery({queryKey:e,queryFn:async()=>{let e=await o("/v1/sessions/".concat(n),{signal:l.signal,headers:c});if(!e.ok)throw Error("Failed to prefetch session");return e.json()},staleTime:3e5}),a.prefetchInfiniteQuery({queryKey:r,queryFn:async()=>{let e=await o("/v1/sessions/".concat(n,"/events"),{signal:l.signal,headers:c});if(!e.ok)throw Error("Failed to prefetch events");return e.json()},initialPageParam:void 0,getNextPageParam:Q,staleTime:0})};"undefined"!=typeof requestIdleCallback?requestIdleCallback(d):d()},[i,a,o])},L=()=>{let e=(0,d.useQueryClient)(),{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,i=(0,s.mn)();return(0,g.useCallback)(async t=>{if(!n)return;let s=I(n);await Promise.allSettled([e.ensureQueryData({queryKey:[u.Exr,{orgUuid:n,sessionId:t}],queryFn:async()=>{let e=await i("/v1/sessions/".concat(t),{headers:s});if(!e.ok)throw Error("Failed to fetch session metadata");return e.json()}}),e.prefetchInfiniteQuery({queryKey:[u.riq,{orgUuid:n,sessionId:t}],queryFn:async()=>{let e=await i("/v1/sessions/".concat(t,"/events"),{headers:s});if(!e.ok)throw Error("Failed to fetch session events");return e.json()},initialPageParam:void 0,getNextPageParam:Q})])},[n,e,i])};function O(){let e=R(),{mutateAsync:t}=W(),{mutateAsync:n}=V();return(0,g.useCallback)(async i=>{var s,r;let{initialMessage:a,title:o,customPrompt:u,model:c,gitRepoUrl:d,gitRepoUrls:f,sourceBranch:g,sourceBranches:p,outputBranch:h,environmentId:v,mcpConfig:m,mcpTools:y,permissionMode:S}=i,w=!!S&&"default"!==S,E=[];a&&!w&&E.push({type:"event",data:a});let k=[],T=[],x=f&&f.length>0?f:d?[d]:[];for(let e of x){let t=(0,b.iO)(e),n=null!=(s=null==p?void 0:p[null!=t?t:""])?s:e===x[0]?g:void 0;k.push({type:"git_repository",url:e,...n&&{revision:"refs/heads/".concat(n)}}),t&&T.push({type:"git_repository",git_info:{type:"github",repo:t,branches:[null!=h?h:(0,_.j)()]}})}let P=await e.mutateAsync({title:o,events:E,environment_id:v,session_context:{sources:k,outcomes:T,mcp_config:m,mcp_tools:y,...void 0!==u?{custom_system_prompt:u}:{},...void 0!==c?{model:c}:{}}});return w&&a&&P.id&&(await t({sessionId:P.id,mode:S}),await n({sessionId:P.id,uuid:null!=(r=a.uuid)?r:(0,l.b)(),message:a.message})),P},[e,t,n])}let R=()=>{let{activeOrganization:e}=(0,r.YL)(),t=(0,d.useQueryClient)(),n=null==e?void 0:e.uuid;return(0,s.L2)("/v1/sessions","POST",{onSuccess:e=>{t.setQueryData([u.Rvf,{orgUuid:n}],t=>{if(!(null==t?void 0:t.pages)||0===t.pages.length)return{pages:[{data:[e],has_more:!1,first_id:e.id,last_id:e.id}],pageParams:[void 0]};let[n,...i]=t.pages;return{...t,pages:[{...n,data:[e,...n.data],first_id:e.id},...i]}}),t.setQueryData([u.Exr,{orgUuid:n,sessionId:e.id}],{...e,type:"internal_session"})},meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...n?{"x-organization-uuid":n}:{}}})};function j(){let e=(()=>{let{activeOrganization:e}=(0,r.YL)(),t=(0,d.useQueryClient)(),n=null==e?void 0:e.uuid;return(0,s.L2)("/v1/sessions","POST",{onSuccess:e=>{t.setQueryData([u.Rvf,{orgUuid:n}],t=>{if(!(null==t?void 0:t.pages)||0===t.pages.length)return{pages:[{data:[e],has_more:!1,first_id:e.id,last_id:e.id}],pageParams:[void 0]};let[n,...i]=t.pages;return{...t,pages:[{...n,data:[e,...n.data],first_id:e.id},...i]}})},meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"baku",...n?{"x-organization-uuid":n}:{}}})})();return(0,g.useCallback)(t=>{let{title:n,environmentId:i,model:s,initialMessage:r}=t,a=[];return r&&a.push({type:"event",data:r}),e.mutateAsync({title:n,events:a,environment_id:i,session_context:{model:s}})},[e])}function A(){let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,s.L2)("/api/organizations/".concat(t,"/dust/generate_session_title"),"POST")}function B(e,t,n){return e.map(e=>({...e,data:e.data.map(e=>e.id===t?n(e):e)}))}function z(e,t){return{onMutate:async n=>{let i=[u.Rvf,{orgUuid:e}],s=[u.Exr,{orgUuid:e,sessionId:n.sessionId}];await Promise.all([t.cancelQueries({queryKey:i}),t.cancelQueries({queryKey:s})]);let r=t.getQueryData(i),a=t.getQueryData(s);return t.setQueryData(i,e=>(null==e?void 0:e.pages)?{...e,pages:B(e.pages,n.sessionId,e=>({...e,...n.optimisticUpdate}))}:e),t.setQueryData(s,e=>e?{...e,...n.optimisticUpdate}:e),{previousSessionsList:r,previousSession:a}},onError:(n,i,s)=>{(null==s?void 0:s.previousSessionsList)&&t.setQueryData([u.Rvf,{orgUuid:e}],s.previousSessionsList),(null==s?void 0:s.previousSession)&&t.setQueryData([u.Exr,{orgUuid:e,sessionId:i.sessionId}],s.previousSession)},onSuccess:(n,i)=>{t.setQueryData([u.Rvf,{orgUuid:e}],e=>(null==e?void 0:e.pages)?{...e,pages:B(e.pages,i.sessionId,()=>n)}:e),t.setQueryData([u.Exr,{orgUuid:e,sessionId:i.sessionId}],n)}}}function U(){let{activeOrganization:e}=(0,r.YL)(),t=(0,d.useQueryClient)(),n=null==e?void 0:e.uuid,i=z(n,t);return(0,s.L2)(e=>"/v1/sessions/".concat(e.sessionId),"PATCH",{transformVariables:e=>({title:e.title,session_status:e.session_status}),onMutate:e=>i.onMutate({sessionId:e.sessionId,optimisticUpdate:e}),onError:i.onError,onSuccess:i.onSuccess,meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...n?{"x-organization-uuid":n}:{}}})}function N(){let{activeOrganization:e}=(0,r.YL)(),t=(0,d.useQueryClient)(),n=null==e?void 0:e.uuid,i=z(n,t);return(0,s.L2)(e=>"/v1/sessions/".concat(e.sessionId,"/archive"),"POST",{transformVariables:()=>({}),onMutate:e=>i.onMutate({sessionId:e.sessionId,optimisticUpdate:{session_status:"archived"}}),onError:i.onError,onSuccess:i.onSuccess,meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...n?{"x-organization-uuid":n}:{}}})}function Y(){let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,s.L2)(e=>"/v1/sessions/".concat(e.sessionId,"/events"),"POST",{transformVariables:()=>({events:[{type:"control_request",request_id:"interrupt-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(7)),request:{subtype:"interrupt"}}]}),meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...t?{"x-organization-uuid":t}:{}}})}function K(){let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,s.L2)(e=>"/v1/sessions/".concat(e.sessionId,"/events"),"POST",{transformVariables:e=>{var t;return{events:[{type:"control_response",response:{subtype:"success",request_id:e.requestId,response:{toolUseID:e.toolUseId,...en(e.toolName,null!=(t=e.input)?t:{},e.decision,e.suggestions)}}}]}},meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...t?{"x-organization-uuid":t}:{}}})}function F(){let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,s.L2)(e=>"/v1/sessions/".concat(e.sessionId,"/mcp-approvals"),"POST",{transformVariables:e=>({tool_name:e.toolName,scope:e.scope,tool_use_id:e.toolUseId}),meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29",...t?{"x-organization-uuid":t}:{}}})}function V(){let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,s.L2)(e=>"/v1/sessions/".concat(e.sessionId,"/events"),"POST",{transformVariables:e=>({events:[{type:"user",uuid:e.uuid,session_id:e.sessionId,parent_tool_use_id:null,message:e.message}]}),meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...t?{"x-organization-uuid":t}:{}}})}function W(){let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,s.L2)(e=>"/v1/sessions/".concat(e.sessionId,"/events"),"POST",{transformVariables:e=>({events:[{type:"control_request",request_id:"set-perm-mode-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(7)),request:{subtype:"set_permission_mode",mode:e.mode}}]}),meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...t?{"x-organization-uuid":t}:{}}})}function G(){let{activeOrganization:e}=(0,r.YL)(),t=(0,d.useQueryClient)(),n=null==e?void 0:e.uuid;return(0,s.L2)(e=>"/v1/sessions/".concat(e.sessionId),"DELETE",{transformVariables:()=>({}),onMutate:async e=>{let i=[u.Rvf,{orgUuid:n}],s=[u.Exr,{orgUuid:n,sessionId:e.sessionId}];await Promise.all([t.cancelQueries({queryKey:i}),t.cancelQueries({queryKey:s})]);let r=t.getQueryData(i),a=t.getQueryData(s);return t.setQueryData(i,t=>{var n,i;return(null==t?void 0:t.pages)?{...t,pages:(n=t.pages,i=e.sessionId,n.map(e=>({...e,data:e.data.filter(e=>e.id!==i)})))}:t}),t.removeQueries({queryKey:s}),{previousSessionsList:r,previousSession:a}},onError:(e,i,s)=>{(null==s?void 0:s.previousSessionsList)&&t.setQueryData([u.Rvf,{orgUuid:n}],s.previousSessionsList),(null==s?void 0:s.previousSession)&&t.setQueryData([u.Exr,{orgUuid:n,sessionId:i.sessionId}],s.previousSession)},meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...n?{"x-organization-uuid":n}:{}}})}let J=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="/v1/sessions/ws/".concat(t,"/subscribe"),s=new URLSearchParams;s.append("organization_uuid",e),n.replay&&s.append("replay","true");let r=s.toString();r&&(i+="?".concat(r));let a="https:"===window.location.protocol?"wss:":"ws:";return"".concat(a,"//").concat(window.location.host).concat(i)},H=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{activeOrganization:n}=(0,r.YL)(),i=null==n?void 0:n.uuid,a=(0,s.iC)("/v1/sessions/".concat(e,"/events"),{queryKey:[u.riq,{orgUuid:i,sessionId:e}],enabled:!!n&&t,pageParamName:"after_id",getNextPageParam:e=>{var t;if(!e.has_more)return;let n=e.last_id||(null==(t=e.data[e.data.length-1])?void 0:t.uuid)||null;return null!=n?n:void 0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...i?{"x-organization-uuid":i}:{}},meta:{noToast:!0},staleTime:0}),{hasNextPage:o,isFetchingNextPage:l,fetchNextPage:c,isError:d}=a,f=a.data;return(0,g.useEffect)(()=>{!o||l||d||c()},[o,l,c,d]),{data:(0,g.useMemo)(()=>{var e,t,n,i;if(!(null==f?void 0:f.pages))return;let s=f.pages.flatMap(e=>e.data);return{data:s,has_more:!1,first_id:null!=(n=null==(e=s[0])?void 0:e.uuid)?n:null,last_id:null!=(i=null==(t=s[s.length-1])?void 0:t.uuid)?i:null}},[null==f?void 0:f.pages]),isLoading:a.isLoading,isError:a.isError,error:a.error,refetch:a.refetch,isFetching:a.isFetching}},$=(e,t)=>{var n;let{activeOrganization:i,account:a}=(0,r.YL)(),o=null==i?void 0:i.uuid,u=!!a&&(null==t?void 0:t.has_more)===!0&&!!(null==t?void 0:t.last_id),l=(0,s.iC)("/v2/sessions-share/".concat(e,"?limit=1000"),{queryKey:["SHARED_SESSION_EVENTS",{orgUuid:o,sessionId:e,initialLastId:null==t?void 0:t.last_id}],enabled:u,pageParamName:"after_id",initialPageParam:null!=(n=null==t?void 0:t.last_id)?n:void 0,getNextPageParam:e=>{var t;if(!e.has_more)return;let n=e.last_id||(null==(t=e.data[e.data.length-1])?void 0:t.uuid)||null;return null!=n?n:void 0},headers:{"anthropic-version":"2023-06-01",...o?{"x-organization-uuid":o}:{}},meta:{noToast:!0}}),{hasNextPage:c,isFetchingNextPage:d,fetchNextPage:f,isError:p}=l,h=l.data;(0,g.useEffect)(()=>{!c||d||p||f()},[c,d,f,p]);let v=(0,g.useMemo)(()=>{var e,n;return[...null!=(e=null==t?void 0:t.data)?e:[],...null!=(n=null==h?void 0:h.pages.flatMap(e=>e.data))?n:[]]},[null==t?void 0:t.data,null==h?void 0:h.pages]),m=u&&(d||!!c);return{messages:v,isLoading:l.isLoading,isPaginating:m}};function X(e){let t=(0,s.mn)(),{activeOrganization:n}=(0,r.YL)(),i=null==n?void 0:n.uuid,a=(0,d.useQueryClient)();return(0,g.useCallback)(async n=>a.fetchQuery({queryKey:["session-recovery-check",e,n,i],queryFn:async()=>{let s=new URLSearchParams;n&&s.append("after_id",n);let r=await t("/v1/sessions/".concat(e,"/events?").concat(s.toString()),{headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...i?{"x-organization-uuid":i}:{}}});if(!r.ok)throw Error("Events check failed: ".concat(r.status));return r.json()},staleTime:0}),[a,e,t,i])}class Z{[Symbol.asyncIterator](){if(this.started)throw Error("Stream can only be iterated once");return this.started=!0,this}next(){return this.queue.length>0?Promise.resolve({done:!1,value:this.queue.shift()}):this.isDone?Promise.resolve({done:!0,value:void 0}):this.hasError?Promise.reject(this.hasError):new Promise((e,t)=>{this.readResolve=e,this.readReject=t})}enqueue(e){if(this.readResolve){let t=this.readResolve;this.readResolve=void 0,this.readReject=void 0,t({done:!1,value:e})}else this.queue.push(e)}done(){if(this.isDone=!0,this.readResolve){let e=this.readResolve;this.readResolve=void 0,this.readReject=void 0,e({done:!0,value:void 0})}}error(e){if(this.hasError=e,this.readReject){let t=this.readReject;this.readResolve=void 0,this.readReject=void 0,t(e)}}return(){return this.isDone=!0,this.returned&&this.returned(),Promise.resolve({done:!0,value:void 0})}constructor(e){this.returned=e,this.queue=[],this.isDone=!1,this.started=!1}}function ee(e,t,n,a,o){let f=!(arguments.length>5)||void 0===arguments[5]||arguments[5],h=arguments.length>6&&void 0!==arguments[6]&&arguments[6],_=arguments.length>7?arguments[7]:void 0,b=arguments.length>8?arguments[8]:void 0,E=arguments.length>9?arguments[9]:void 0,{data:k,isLoading:T,isError:x,refetch:P}=H(e,f),{mutateAsync:M}=V(),{mutateAsync:D}=function(){let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,s.L2)(e=>"/v1/sessions/".concat(e.sessionId,"/events"),"POST",{transformVariables:e=>({events:[{type:"control_request",request_id:"set-model-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(7)),request:{subtype:"set_model",model:e.model}}]}),meta:{noToast:!0},headers:{"anthropic-version":"2023-06-01","anthropic-beta":"ccr-byoc-2025-07-29","anthropic-client-feature":"ccr",...t?{"x-organization-uuid":t}:{}}})}(),{track:C}=(0,i.st)(),I=(0,g.useCallback)(async()=>{var t,n;let i=null!=(n=v.Ou.getState().pendingMessages[e])?n:[];if(0===i.length)return;let s=await P(),r=new Set,a=null==(t=s.data)?void 0:t.pages;if(a)for(let e of a)for(let t of e.data)t.uuid&&r.add(t.uuid);for(let t of i)if(t.session_id&&t.uuid&&!r.has(t.uuid))try{await M({sessionId:e,uuid:t.uuid,message:t.message})}catch(e){}},[P,e,M]),{streamedMessages:Q,interrupt:q,ensureConnected:L,retryNow:O,softRetry:R,connectionState:j,lastMessageTime:A,nextReconnectTime:B,permissionMode:z,setPermissionMode:U,slashCommands:N,mergeRecoveredEvents:Y}=function(e,t,n,s,a){let o=!(arguments.length>5)||void 0===arguments[5]||arguments[5],l=!(arguments.length>6)||void 0===arguments[6]||arguments[6],f=arguments.length>7?arguments[7]:void 0,h=arguments.length>8?arguments[8]:void 0,_=(0,g.useRef)(null),b=(0,g.useRef)(null),E=(0,g.useRef)(!1),k=(0,g.useRef)(0),T=(0,g.useRef)(null),x=(0,g.useRef)(null),P=(0,g.useRef)(null),[M,D]=(0,g.useState)([]),[C,I]=(0,g.useState)("disconnected"),[Q,q]=(0,g.useState)(null),[L,O]=(0,g.useState)(null!=h?h:"default"),[R,j]=(0,g.useState)([]),[A,B]=(0,g.useState)(null),z=(0,v.Tk)(e),{mutateAsync:U}=W(),{track:N}=(0,i.st)(),Y=(0,g.useRef)(N);Y.current=N;let K=(0,g.useRef)(e),F=(0,g.useCallback)(e=>{let t=x.current;t&&Y.current({event_key:"claudeai.session.disconnecting",session_id:t,reason:null!=e?e:"unknown"}),E.current=!0,I("disconnected"),q(null),B(null),T.current&&(clearTimeout(T.current),T.current=null),b.current&&(b.current.abort(),b.current=null),P.current&&(P.current.done(),P.current=null),_.current=null,x.current=null,("user_initiated"===e||"session_id_changed"===e)&&(k.current=0)},[]);(0,g.useEffect)(()=>{K.current!==e&&(F("session_id_changed"),D([]),I("disconnected"),q(null),k.current=0,K.current=e)},[e,F]);let{activeOrganization:V}=(0,r.YL)(),G=null==V?void 0:V.uuid,H=(0,d.useQueryClient)(),$=(0,g.useRef)(s);$.current=s;let X=(0,g.useRef)(new Set),ee=(0,g.useCallback)(()=>{var t,i;if(!o||!G||!e||_.current&&x.current===e)return;F(),Y.current({event_key:"claudeai.session.connecting",session_id:e}),E.current=!1,I("connecting"),x.current=e,b.current=new AbortController,P.current=new Z;let s=(0,c.P)({prompt:P.current,websocket:{url:J(G,e)},abortController:b.current,mcpServers:a,canUseTool:(t=$,i=X,async(e,n,s)=>{var r;if(!function(e,t){if(y.c.REQUIRES_INPUT.has(e))return!0;if(e.includes("__")){let[t,n,i]=e.split("__");return"mcp"===t&&!!n&&!!i}return!0}(e,i.current))return{behavior:"deny",message:"Invalid tool name format"};let a=await t.current(e,n,{toolUseID:s.toolUseID,suggestions:s.suggestions,signal:s.signal});return en(e,null!=(r=a.updatedInput)?r:n,a.decision,s.suggestions)})});(null==f?void 0:f.maxThinkingTokens)!==void 0&&s.setMaxThinkingTokens(f.maxThinkingTokens),h&&"default"!==h&&U({sessionId:e,mode:h});let r=null;(async()=>{var t,n,i,a,o;try{let o=new Map,l=!0,c=null;for await(let d of(r=setTimeout(()=>{l&&I("connected")},500),s)){if(l&&(l=!1,clearTimeout(r),Y.current({event_key:"claudeai.session.connected",session_id:e}),k.current=0,I("connected")),q(Date.now()),"system"===d.type){if(X.current=new Set(d.tools),d.slash_commands&&d.slash_commands.length>0){let e=d.slash_commands.map(e=>({name:e,description:"",argumentHint:""}));j(e)}d.permissionMode&&(!h||"default"===h)&&O(d.permissionMode)}if((0,p.Dc)(d)&&"content_block_start"===d.event.type&&(null==(t=d.event.content_block)?void 0:t.type)==="tool_use"&&d.event.content_block.name===p.eV&&void 0!==d.event.index?(c=d.event.index,p.QQ.getState().setElicitStreamActive(!0),p.QQ.getState().pushStreamEvent(d)):null!==c&&(0,p.Dc)(d)&&"content_block_delta"===d.event.type&&(null==(n=d.event.delta)?void 0:n.type)==="input_json_delta"&&d.event.index===c?p.QQ.getState().pushStreamEvent(d):null!==c&&(0,p.Dc)(d)&&"content_block_stop"===d.event.type&&d.event.index===c?(p.QQ.getState().pushStreamEvent(d),c=null,p.QQ.getState().setElicitStreamActive(!1)):D(e=>d.uuid&&e.some(e=>e.uuid===d.uuid)?e:[...e,{...d,receivedStreamAt:Date.now()}]),"assistant"===d.type&&"message"in d){let e=null==(i=d.message)?void 0:i.content;if(Array.isArray(e))for(let t of e)"tool_use"===t.type&&t.id&&t.name&&o.set(t.id,{name:t.name,id:t.id,input:t.input})}if("user"===d.type&&"message"in d){let t=null==(a=d.message)?void 0:a.content;if(Array.isArray(t)){for(let n of t)if("tool_result"===n.type&&n.tool_use_id){let t=o.get(n.tool_use_id),i=(null==t?void 0:t.name)==="mcp__git__git_push",s=(null==t?void 0:t.name)==="Bash"&&(0,S.e)(t.input),r=(null==t?void 0:t.name)==="Bash"&&(0,S.eo)(t.input),a=(null==t?void 0:t.name)==="mcp__github__create_pull_request";(i||s||a)&&(H.invalidateQueries({queryKey:[u.i8w],refetchType:"all"}),H.invalidateQueries({queryKey:[u.uhr],refetchType:"all"})),(i||s)&&(0,m.xh)(e),(i||r)&&H.invalidateQueries({queryKey:[u.Owg],refetchType:"all"})}}}}}catch(i){r&&clearTimeout(r),p.QQ.getState().clearStreamEvents();let t=E.current,n=null==(o=b.current)?void 0:o.signal.aborted;if(E.current=!1,_.current===s&&(I("disconnected"),_.current=null),l&&!t&&!n&&i instanceof Error&&"WebSocket connection aborted by user"!==i.message){let t=k.current;if(t<5){let n=t+1;k.current=n;let s=1e3*Math.pow(2,t),r=Math.random()*s*.5,a=s+r;Y.current({event_key:"claudeai.session.reconnecting",session_id:e,attempt:n,max_retries:5,delay_ms:Math.round(a),error:i instanceof Error?i.message:String(i)}),B(Date.now()+a),T.current=setTimeout(()=>{B(null),ee()},a)}else Y.current({event_key:"claudeai.session.reconnection_failed",session_id:e,max_retries:5,error:i instanceof Error?i.message:String(i)})}else t||n||Y.current({event_key:"claudeai.session.disconnected_due_to_error",session_id:e,error:i instanceof Error?i.message:String(i),reconnect_on_error:l})}})(),_.current=s,a&&Object.keys(a).length>0?(async()=>{try{await Promise.race([s.supportedCommands(),new Promise((e,t)=>setTimeout(()=>t(Error("SDK init timed out")),1e4))])}catch(e){}n()})():n()},[o,G,e,F,n,l,a,H,null==f?void 0:f.maxThinkingTokens,h,U]);(0,g.useEffect)(()=>()=>F("user_initiated"),[F]),(0,g.useEffect)(()=>{if(!Q||"connected"!==C||(0,w.ms)(M,z))return;let e=3e5-(Date.now()-Q);if(e<=0)return void F("idle_timeout");let t=setTimeout(()=>{F("idle_timeout")},e);return()=>{clearTimeout(t)}},[Q,C,M,z,F]);let et=(0,g.useCallback)(()=>{_.current&&(E.current=!0,_.current.interrupt())},[]),ei=(0,g.useCallback)(t=>{O(t),U({sessionId:e,mode:t})},[U,e]),es=(0,g.useCallback)(()=>{_.current||(k.current=0,ee())},[ee]),er=(0,g.useCallback)(()=>{T.current&&(clearTimeout(T.current),T.current=null),B(null),k.current=0,et(),setTimeout(()=>{ee()},100)},[et,ee]);return{streamedMessages:M,interrupt:et,ensureConnected:es,retryNow:er,softRetry:(0,g.useCallback)(()=>{T.current&&(clearTimeout(T.current),T.current=null),B(null),k.current=0,F(),ee()},[F,ee]),connectionState:C,lastMessageTime:Q,nextReconnectTime:A,permissionMode:L,setPermissionMode:ei,slashCommands:R,mergeRecoveredEvents:(0,g.useCallback)(e=>{D(t=>{let n=new Set(t.map(e=>e.uuid).filter(Boolean)),i=e.filter(e=>e.uuid&&!n.has(e.uuid));return 0===i.length?t:[...t,...i.map(e=>({...e,receivedStreamAt:Date.now()}))]})},[])}}(e,t,I,n,a,f&&!x,h,_,b),K=(0,g.useRef)(E);void 0!==E&&void 0===K.current&&(K.current=E);let F=(0,v.Tk)(e),G=(0,v.jT)(),$=(0,v.Ou)(e=>e.removePendingMessage),X=(0,v.Ou)(e=>e.clearPendingMessages),ee=(0,g.useMemo)(()=>{if(T||!k)return[];let e=new Set;return k.data.filter(t=>!(!t.uuid||e.has(t.uuid))&&(e.add(t.uuid),!0))},[T,k]),et=(0,g.useMemo)(()=>{let e=ee.find(e=>"system"===e.type);return(null==e?void 0:e.slash_commands)&&e.slash_commands.length>0?e.slash_commands.map(e=>({name:e,description:"",argumentHint:""})):[]},[ee]),ei=N.length>0?N:et,es=(0,g.useMemo)(()=>{let e=new Map;for(let t of ee)t.uuid&&e.set(t.uuid,t);for(let t of Q)t.uuid&&e.set(t.uuid,t);return Array.from(e.values())},[ee,Q]);(0,g.useEffect)(()=>{for(let t of es)t.uuid&&$(e,t.uuid)},[es,e,$]);let er=(0,g.useCallback)(async(t,n,i)=>{let s,r=(0,l.b)(),a={uuid:r,type:"user",session_id:e,parent_tool_use_id:null,message:{role:"user",content:t}};if(G(e,a),i&&i!==K.current)try{var o;await D({sessionId:e,model:i}),C({event_key:"claudeai.code.model_switched",session_id:e,previous_model:null!=(o=K.current)?o:"unknown",new_model:i,session_type:"remote"}),K.current=i}catch(e){}for(let t=0;t<3;t++)try{await M({sessionId:e,uuid:r,message:a.message});return}catch(e){s=e instanceof Error?e:Error(String(e)),t<2&&await new Promise(e=>setTimeout(e,1e3*2**t))}throw null!=s?s:Error("All send attempts failed")},[G,e,M,D,C]),ea=(0,g.useMemo)(()=>{if(0===F.length)return[];let e=new Set;for(let t of es)e.add(t.uuid);return F.filter(t=>!e.has(t.uuid))},[F,es]);(0,g.useEffect)(()=>{o&&L()},[L,o]),(0,g.useEffect)(()=>{ea.length>0&&L()},[ea.length,L]);let eo=(0,g.useCallback)(()=>{q(),X(e)},[q,X,e]),eu=(0,g.useCallback)(()=>{O()},[O]),el=(0,g.useMemo)(()=>(0,w.ms)(es,F),[es,F]);return{loadingInitialMessages:T,initialMessagesError:x,sendMessage:er,stopSession:eo,initialMessages:null==k?void 0:k.data,streamedMessages:Q,messages:es,pendingMessages:ea,ensureConnected:L,connectionState:j,lastMessageTime:A,nextReconnectTime:B,retry:eu,softRetry:R,isSessionRunning:el,permissionMode:z,setPermissionMode:U,slashCommands:ei,refetchInitialMessages:P,mergeRecoveredEvents:Y}}let et="The user doesn't want to proceed with this tool use. The tool use was rejected (eg. if it was a file edit, the new_string was NOT written to the file). To tell you how to proceed, the user said:\n";function en(e,t,n,i){let s;if("deny"===n){let e=t._feedbackMessage;return{behavior:"deny",message:"string"==typeof e&&e?"".concat(et).concat(e):"Denied by user"}}return"ExitPlanMode"===e?s=[{type:"setMode",mode:"default",destination:"session"}]:"always"===n&&(s=(null==i?void 0:i.length)?i:[{type:"replaceRules",rules:[{toolName:e}],behavior:"allow",destination:"localSettings"}]),{behavior:"allow",updatedInput:t,updatedPermissions:s}}let ei="diff-cache";function es(e,t,n,i,s){return"".concat(e,":").concat(t,"/").concat(n,":").concat(i,":").concat(s)}function er(){try{let e=localStorage.getItem(ei);if(!e)return{};return JSON.parse(e)}catch(e){return{}}}function ea(e){try{localStorage.setItem(ei,JSON.stringify(e))}catch(e){}}let eo=e=>{var t;let{sessionId:n,owner:i,repo:l,base:c,head:d,enabled:p=!0}=e,{activeOrganization:v}=(0,r.YL)(),m=null==v?void 0:v.uuid,y=(0,s.mn)(),_=(0,h._)(e=>e.setDiffStats),b=(0,g.useMemo)(()=>n&&i&&l&&c&&d?function(e,t,n,i,s){let r=er(),a=es(e,t,n,i,s),o=r[a];if(o){if(Date.now()-o.timestamp>864e5){delete r[a],ea(r);return}return o.data}}(n,i,l,c,d):void 0,[]),S=(0,f.useQuery)({queryKey:[u.Owg,{orgUuid:m,sessionId:n,owner:i,repo:l,base:c,head:d}],queryFn:async()=>{let e=await y("/v1/session_ingress/session/".concat(n,"/git_proxy/compare"),{method:"POST",headers:{"Content-Type":"application/json",...m?{"x-organization-uuid":m}:{}},body:JSON.stringify({owner:i,repo:l,base:c,head:d})});if(404===e.status)return null;if(!e.ok){let t=await e.json();throw(0,a.a5)({status:e.status,response:t,fallbackMessage:"Failed to compare branches.",endpoint:"/v1/session_ingress/session/".concat(n,"/git_proxy/compare"),method:"POST"})}let t=await e.json();return!function(e,t,n,i,s,r){let a=er();a[es(e,t,n,i,s)]={data:r,timestamp:Date.now()};let o=Object.entries(a);if(o.length>20)for(let[e]of(o.sort((e,t)=>e[1].timestamp-t[1].timestamp),o.slice(0,o.length-20)))delete a[e];ea(a)}(n,i,l,c,d,t),t},enabled:!!(v&&n&&i&&l&&c&&d&&p),staleTime:3e4,refetchOnWindowFocus:!0,placeholderData:b,meta:{noToast:e=>e.message.includes("No changes between")||e.message.includes("No changes found between")},...o.Qr}),w=(0,g.useMemo)(()=>{var e;if(!(null==(e=S.data)?void 0:e.files))return;let{additions:t,deletions:n,fileCount:i}=S.data.files.reduce((e,t)=>({additions:e.additions+t.additions,deletions:e.deletions+t.deletions,fileCount:e.fileCount+1}),{additions:0,deletions:0,fileCount:0});return{additions:t,deletions:n,fileCount:i,hasChanges:i>0}},[null==(t=S.data)?void 0:t.files]);return(0,g.useEffect)(()=>{w&&n&&i&&l&&c&&d&&_(n,i,l,c,d,w)},[w,n,i,l,c,d,_]),{...S,diffStats:w}},eu=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,s.L2)(e=>{let{sessionId:t}=e;return"/v1/session_ingress/session/".concat(t,"/git_proxy/file")},"POST",{meta:{noToast:!0},transformVariables:e=>{let{owner:t,repo:n,path:i,ref:s}=e;return{owner:t,repo:n,path:i,...s?{ref:s}:{}}},headers:t?{"x-organization-uuid":t}:{}})}},0xc5c5a42b:(e,t,n)=>{function i(e){if(!e||"object"!=typeof e)return null;let t=e.command;return"string"!=typeof t?null:t}function s(e){let t=i(e);return!!t&&/^\s*git\s+(commit|reset|checkout|rebase|cherry-pick|revert|merge|stash|restore|pull|push|am|apply)\b/.test(t)}function r(e){let t=i(e);return!!t&&/^\s*git\s+push\b/.test(t)}n.d(t,{e:()=>r,eo:()=>s})},0x11e751567:(e,t,n)=>{n.d(t,{Q:()=>s,c:()=>i});let i={CUSTOM_UI:new Set(["ExitPlanMode"]),REQUIRES_INPUT:new Set(["AskUserQuestion","ExitPlanMode","mcp__elicit__present_options"]),NATIVE_CC_TOOLS:new Set(["Bash","Read","Write","Edit","Glob","Grep","WebFetch","WebSearch","Task","Tmux","REPL","JavaScript","AskUserQuestion","ExitPlanMode","EnterPlanMode","Config","TaskCreate","TaskGet","TaskList","TaskUpdate","TaskStop","Skill","Teammate","SendMessage","Handoff","VerifyPlanExecution","ToolSearch","TerminalCapture"])};function s(e){var t;return null!=(t=null==e?void 0:e.filter(e=>!i.CUSTOM_UI.has(e.toolName)))?t:[]}},0x1343ac650:(e,t,n)=>{n.d(t,{j:()=>a});let i=["admiring","adoring","affectionate","amazing","awesome","beautiful","blissful","bold","brave","busy","charming","clever","cool","compassionate","confident","dazzling","determined","dreamy","eager","ecstatic","elegant","eloquent","epic","exciting","fervent","festive","focused","friendly","funny","gallant","gifted","gracious","great","happy","hopeful","inspiring","intelligent","jolly","keen","kind","laughing","loving","lucid","magical","modest","nice","nifty","optimistic","peaceful","pensive","practical","quirky","relaxed","serene","sharp","sleepy","stoic","sweet","tender","trusting","upbeat","vibrant","vigilant","wizardly","wonderful","youthful","zealous","zen"],s=["albattani","allen","archimedes","babbage","bardeen","bell","bohr","brahmagupta","brown","cannon","carson","cerf","clarke","cori","cray","curie","darwin","davinci","dijkstra","dirac","edison","einstein","euler","faraday","fermat","fermi","feynman","franklin","galileo","gates","gauss","goldberg","goodall","hamilton","hawking","heisenberg","hopper","hypatia","johnson","keller","knuth","lamport","lovelace","maxwell","mayer","mccarthy","meitner","mendel","newton","noether","pascal","pasteur","planck","ptolemy","ramanujan","ride","ritchie","rubin","sagan","shannon","tesla","thompson","turing","volta","wozniak","wright"];function r(e){return e[Math.floor(Math.random()*e.length)]}function a(){return"claude/".concat(r(i),"-").concat(r(s))}},0x144bc081e:(e,t,n)=>{n.d(t,{Gx:()=>c,Ik:()=>s,Uw:()=>l,Xk:()=>r,iO:()=>u,m0:()=>o,tM:()=>a});let i="https://github.com";function s(e){let t,{repo:n,branchName:s,baseBranch:r,title:a,body:o,upstreamRepo:u,githubHost:l=i}=e,c=u||n;if(u){let e=n.split("/")[0];t=r?"".concat(r,"...").concat(e,":").concat(s):"".concat(e,":").concat(s)}else t=r?"".concat(r,"...").concat(s):s;let d=new URLSearchParams({quick_pull:"1"});return a&&d.set("title",a),o&&d.set("body",o),"".concat(l,"/").concat(c,"/compare/").concat(t,"?").concat(d.toString())}function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;return"".concat(n,"/").concat(e,"/pull/").concat(t)}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;return"".concat(t,"/").concat(e)}function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;return"".concat(n,"/").concat(e,"/blob/").concat(t)}function u(e){let t=e.match(/[^@]+@[^:]+:([^/]+\/[^/]+?)(?:\.git)?$/);if(t)return t[1];let n=e.match(/https?:\/\/[^/]+\/([^/]+\/[^/]+?)(?:\.git)?$/);if(n)return n[1]}function l(e){let t=e.match(/^(https?:\/\/[^/]+)/);if(t)return t[1];let n=e.match(/[^@]+@([^:]+):/);if(n)return"https://".concat(n[1])}function c(e){if(!e)return;let t=l(e);return t&&t!==i?t:void 0}},0x17a32add1:(e,t,n)=>{n.d(t,{Eq:()=>l,SO:()=>c,g1:()=>u,k1:()=>f,xh:()=>d});var i=n(0xfc89b4a4);function s(e,t){if(!e)return[];if(void 0!==t){let n=e[t];return n?Object.values(n).sort((e,t)=>e.sequence-t.sequence):[]}let n=[];for(let t of Object.values(e))for(let e of Object.values(t))n.push(e);return n.sort((e,t)=>e.sequence-t.sequence)}function r(e){if(0===e.length)return{additions:0,deletions:0,fileCount:0,hasChanges:!1};let t=0,n=0;for(let i of e)t+=i.gitDiff.additions,n+=i.gitDiff.deletions;return{additions:t,deletions:n,fileCount:e.length,hasChanges:!0}}let a=(0,n(0x394ef833).v)((e,t)=>({diffsBySession:{},sequenceCounter:0,trackDiff:function(t,n,i,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";e(e=>{var a,o;let u=e.sequenceCounter+1,l=null!=(a=e.diffsBySession[t])?a:{},c=null!=(o=l[r])?o:{};return{sequenceCounter:u,diffsBySession:{...e.diffsBySession,[t]:{...l,[r]:{...c,[n]:{filePath:n,gitDiff:i,sequence:u,diffKey:s}}}}}})},getSessionDiffs:(e,n)=>s(t().diffsBySession[e],n),getSessionStats:(e,n)=>r(s(t().diffsBySession[e],n)),clearSession:(t,n)=>{e(e=>{if(void 0!==n){let i=e.diffsBySession[t];if(!i)return e;let{[n]:s,...r}=i;if(0===Object.keys(r).length){let{[t]:n,...i}=e.diffsBySession;return{diffsBySession:i}}return{diffsBySession:{...e.diffsBySession,[t]:r}}}let{[t]:i,...s}=e.diffsBySession;return{diffsBySession:s}})},clearFileDiff:function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e(e=>{let s=e.diffsBySession[t];if(!s)return e;let r=s[i];if(!r)return e;let{[n]:a,...o}=r;if(0===Object.keys(o).length){let{[i]:n,...r}=s;if(0===Object.keys(r).length){let{[t]:n,...i}=e.diffsBySession;return{diffsBySession:i}}return{diffsBySession:{...e.diffsBySession,[t]:r}}}return{diffsBySession:{...e.diffsBySession,[t]:{...s,[i]:o}}}})}})),o={additions:0,deletions:0,fileCount:0,hasChanges:!1};function u(e,t){let n=a(t=>e?t.diffsBySession[e]:void 0);return(0,i.useMemo)(()=>s(n,t),[n,t])}function l(e,t){let n=a(t=>e?t.diffsBySession[e]:void 0);return(0,i.useMemo)(()=>n?r(s(n,t)):o,[n,t])}function c(e,t,n,i,s){a.getState().trackDiff(e,t,n,i,s)}function d(e,t){a.getState().clearSession(e,t)}function f(e){return{base_branch:"",head_branch:"",ahead_by:0,behind_by:0,total_commits:0,files:e.map(e=>({filename:e.gitDiff.filename,status:function(e){switch(e){case"deleted":return"removed";case"copied":return"modified";default:return e}}(e.gitDiff.status),additions:e.gitDiff.additions,deletions:e.gitDiff.deletions,changes:e.gitDiff.changes,patch:e.gitDiff.patch,previous_filename:e.gitDiff.previous_filename})),diff_url:""}}},0x21687185c:(e,t,n)=>{n.d(t,{Mo:()=>o,Ou:()=>r,Tk:()=>c,YJ:()=>u,jT:()=>a});var i=n(0x394ef833),s=n(0x16784b660);let r=(0,i.v)()((0,s.Zr)(e=>({pendingMessages:{},addPendingMessage:(t,n)=>{e(e=>({pendingMessages:{...e.pendingMessages,[t]:[...e.pendingMessages[t]||[],n]}}))},clearPendingMessages:t=>{e(e=>({pendingMessages:{...e.pendingMessages,[t]:[]}}))},removePendingMessage:(t,n)=>{e(e=>({pendingMessages:{...e.pendingMessages,[t]:(e.pendingMessages[t]||[]).filter(e=>e.uuid!==n)}}))}}),{name:"session-pending-messages",storage:(0,s.KU)(()=>sessionStorage)})),a=()=>r(e=>e.addPendingMessage),o=()=>r(e=>e.removePendingMessage),u=()=>r(e=>e.clearPendingMessages),l=[],c=e=>r(t=>{var n;return null!=(n=t.pendingMessages[e])?n:l})}}]);