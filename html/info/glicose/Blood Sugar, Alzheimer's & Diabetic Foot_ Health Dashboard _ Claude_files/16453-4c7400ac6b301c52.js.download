try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="99eb2098-f4b2-48b1-b63f-2a9dbda180fe",e._sentryDebugIdIdentifier="sentry-dbid-99eb2098-f4b2-48b1-b63f-2a9dbda180fe")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16453],{0x10bea109:(e,t,r)=>{r.d(t,{performanceMetrics:()=>m});var n=r(0x9845e38c);class i extends Error{}class s{add(e){this.buffer[this.head]=e,this.head=(this.head+1)%this.maxSize,this.currentSize<this.maxSize&&this.currentSize++}addAll(e){for(let t of e)this.add(t)}flush(){this.head=0,this.currentSize=0,this.buffer=Array(this.maxSize)}get size(){return this.currentSize}get isEmpty(){return 0===this.currentSize}get isFull(){return this.currentSize===this.maxSize}*values(){if(0===this.currentSize)return;let e=this.isFull?this.head:0;for(let t=0;t<this.currentSize;t++){let r=(e+t)%this.maxSize;yield this.buffer[r]}}toArray(){return Array.from(this.values())}getLast(){if(0===this.currentSize)return;let e=(this.head-1+this.maxSize)%this.maxSize;return this.buffer[e]}getFirst(){if(0===this.currentSize)return;let e=this.isFull?this.head:0;return this.buffer[e]}constructor(e){if(this.maxSize=e,this.head=0,this.currentSize=0,e<1)throw new i("RingBuffer maxSize must be 1 or more");this.buffer=Array(e)}}var a=r(0x13d66e7d3),o=r(0x1e10d8e8);class u{get mean(){return this.count>0?this._mean:0}get variance(){return this.count>1?this._m2/(this.count-1):0}get stdDev(){return Math.sqrt(this.variance)}calculate(){let e=this._tail-this._mean;this._mean+=e/this.count;let t=this._tail-this._mean;this._m2+=e*t}getSummary(){return{count:this.count,sum:this.sum,min:this.min,max:this.max,mean:this.mean,variance:this.variance,stdDev:this.stdDev}}reset(){this.count=0,this.sum=0,this.min=1/0,this.max=-1/0,this._mean=0,this._m2=0}add(e){this.count+=1,this.sum+=e,this.min=Math.min(this.min,e),this.max=Math.max(this.max,e),this._tail=e,this.calculate()}constructor(){this.count=0,this.sum=0,this.min=1/0,this.max=-1/0,this._tail=0,this._mean=0,this._m2=0,this.reset()}}class c{init(){if(this.shouldReportMemory=(0,a.Y)(),"PerformanceLongTaskTiming"in window)try{this.events.longTask.observer=this.initLongTaskObserver()}catch(e){n.v.error(n.u.O11Y_INTERNALS,"PerfMon LongTaskObserver failed to init")}if("PerformanceEventTiming"in window)try{this.events.inputDelay.observer=this.initInputDelayObserver()}catch(e){n.v.error(n.u.O11Y_INTERNALS,"PerfMon EventTimingObserver failed to init")}if("PerformanceLongAnimationFrameTiming"in window)try{this.events.longAnimationFrame.observer=this.initLongAnimationFrameObserver()}catch(e){n.v.error(n.u.O11Y_INTERNALS,"PerfMon EventTimingObserver failed to init")}this.startReportMetricsInterval(),this.registerVisibilityHandlers()}initLongTaskObserver(){let e=new PerformanceObserver(e=>{for(let r of e.getEntries()){let{attribution:e}=r;if(this.events.longTask.stats.add(r.duration),r.duration>=250){var t;this.events.longTask.buffer.add({start_time:r.startTime,duration_ms:r.duration,attribution_count:null!=(t=null==e?void 0:e.length)?t:0})}}});return e.observe({entryTypes:["longtask"]}),e}initInputDelayObserver(){let e=new PerformanceObserver(e=>{for(let r of e.getEntries()){let e=r.processingStart?r.processingStart-r.startTime:0;if(e>100){this.events.inputDelay.stats.add(r.duration);let n=Number(r.processingEnd)-Number(r.processingStart);if(e>250||n>250){var t;this.events.inputDelay.buffer.add({start_time:r.startTime,duration_ms:e,processing_duration_ms:n,inp_duration_ms:r.duration,event_name:r.name,event_target_id:(null==(t=r.target)?void 0:t.id)||"unknown_target",is_fid:"first-input"===r.entryType})}}}});return e.observe({entryTypes:["event","first-input"]}),e}initLongAnimationFrameObserver(){let e=new PerformanceObserver(e=>{for(let t of e.getEntries()){let{blockingDuration:e}=t;if(this.events.longAnimationFrame.stats.add(t.duration),t.duration>=250){let r={start_time:t.startTime,duration_ms:t.duration,blocking_duration_ms:e||0};this.events.longAnimationFrame.buffer.add(r)}}});return e.observe({entryTypes:["long-animation-frame"]}),e}startReportMetricsInterval(){let e=()=>{this.reportMetricsTimeoutId=window.setTimeout(()=>{this.reportMetrics(),this.isActive&&e()},12e4)};e()}registerVisibilityHandlers(){document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&this.reportMetrics()},{passive:!0}),window.addEventListener("pagehide",()=>this.reportMetrics(),{passive:!0})}reportNavigationTiming(){try{let e=performance.getEntriesByType("navigation");if(0===e.length)return;let t=e[0],r={time_to_dom_interactive_ms:Math.round(t.domInteractive-t.fetchStart),time_to_dom_content_loaded_ms:Math.round(t.domContentLoadedEventEnd-t.fetchStart),time_to_load_complete_ms:Math.round(t.loadEventEnd-t.fetchStart),dns_lookup_duration_ms:Math.round(t.domainLookupEnd-t.domainLookupStart),tcp_connection_duration_ms:Math.round(t.connectEnd-t.connectStart),request_duration_ms:Math.round(t.responseStart-t.requestStart),response_download_duration_ms:Math.round(t.responseEnd-t.responseStart),document_processing_duration_ms:Math.round(t.domComplete-t.responseEnd),dom_content_loaded_duration_ms:Math.round(t.domContentLoadedEventEnd-t.domContentLoadedEventStart),load_event_duration_ms:Math.round(t.loadEventEnd-t.loadEventStart),unload_duration_ms:Math.round(t.unloadEventEnd-t.unloadEventStart),redirect_duration_ms:Math.round(t.redirectEnd-t.redirectStart),redirect_count:t.redirectCount,navigation_type:t.type};t.secureConnectionStart>0&&(r.tls_duration_ms=Math.round(t.connectEnd-t.secureConnectionStart)),t.workerStart>0&&(r.service_worker_duration_ms=Math.round(t.fetchStart-t.workerStart)),(0,o.r)("page.navigation_timing",{metricType:"navigation_timing",performanceAttributes:r})}catch(e){n.v.error(n.u.O11Y_INTERNALS,"Failed to report navigation timing")}}reportMetrics(){this.isActive&&(this.shouldReportMemory&&(0,o.r)("events.memory_snapshot",{metricType:"memory_snapshot"}),Object.values(this.events).forEach(e=>{let{name:t,stats:r,buffer:n}=e;0!==r.mean&&((0,o.r)("events.".concat(t,".summary"),{metricType:"".concat(t,"_summary"),performanceAttributes:{...r.getSummary()}}),n.toArray().forEach(e=>{let{duration_ms:r,...n}=e;(0,o.r)("events.".concat(t),{metricType:"".concat(t,"_event"),duration:r,performanceAttributes:{...n}})}),r.reset(),n.flush())}))}destroy(){this.isActive=!1,Object.values(this.events).forEach(e=>{var t;null==(t=e.observer)||t.disconnect(),e.observer=void 0}),clearTimeout(this.reportMetricsTimeoutId),this.reportMetricsTimeoutId=void 0,this.reportMetrics()}forceReport(){this.reportMetrics()}constructor(){this.isActive=!0,this.shouldReportMemory=!1,this.events={longTask:{name:"long_task",stats:new u,buffer:new s(100)},inputDelay:{name:"input_delay",stats:new u,buffer:new s(100)},longAnimationFrame:{name:"loaf",stats:new u,buffer:new s(100)}},this.init(),this.reportNavigationTiming()}}var l=r(0x1cd6706d8);class d{initPerfMon(){this.perfMon||(this.perfMon=new c)}trackNewChatInputReady(e){(0,o.r)("page.new_chat_input_ready",{duration:e.duration,attributes:{is_first_load:e.isFirstLoad,is_prog_chat_input:e.isProgChatInput,prog_chat_input_perf_mark_missing:e.progChatInputPerfMarkMissing}}),l.C.clearParentContext()}trackTTFT(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.fromEntries(Object.entries(t).filter(e=>{let[,t]=e;return void 0!==t}).map(e=>{let[t,r]=e;return["chat.".concat(t),r]}));(0,o.r)("chat.time_to_first_token",{metricType:"ttft",duration:e,attributes:r})}trackProjectConversationsReady(e){(0,o.r)("page.project_conversations_ready",{duration:e})}trackMembersListReady(e){(0,o.r)("page.members_list_ready",{duration:e})}trackCodeSessionOpenTime(e,t){(0,o.r)("page.code_session_open_time",{duration:e,attributes:{session_type:t.session_type,is_new_session:t.is_new_session}})}trackSessionListReady(e){(0,o.r)("page.code_session_list_ready",{duration:e})}trackTranscriptLoaded(e,t){(0,o.r)("page.code_transcript_loaded",{duration:e,attributes:{session_type:t.session_type}})}trackRqCacheRestore(e){(0,o.r)("page.rq_cache_restore",{duration:e.fullRestoreMs,attributes:{restore_delay_ms:e.restoreDelayMs,idb_read_ms:e.idbReadMs,preload_used:e.preloadUsed,cache_hit:e.cacheHit,query_count:e.queryCount}})}constructor(){this.perfMon=null}}let m=new d},0x377fd82d:(e,t,r)=>{r.d(t,{PerformanceMetricsProvider:()=>f,B:()=>p});var n=r(0x22102fd88),i=r(0xf32c56dd),s=r(0xdbcbe18a),a=r(0x10bea109),o=r(0x18393fe29),u=r(0x19405b970),c=r(0x4d348f95),l=r(0xfc89b4a4),d=r(0x24b0d7515);let m="prog_chat_input_ready",_=(0,d.p9)("progressively_enhanced_chat_input"),h=(0,l.createContext)(null);function f(e){let{children:t}=e,r=(0,c.usePathname)(),{track:d}=(0,i.st)(),f=(0,l.useRef)(!0),p=(0,l.useRef)(null),v=(0,l.useRef)(!1),y=(0,l.useRef)(null),g=(0,l.useRef)(null),b=(0,l.useRef)(null),w=(0,l.useRef)(void 0),M=(0,l.useRef)(!1),k=(0,l.useRef)(!1),S=(0,l.useRef)(null),E=(0,l.useRef)(null),T=(0,l.useRef)(!1),C=(0,l.useRef)(null),x=(0,l.useRef)(!1),R=(0,l.useRef)(null),A=(0,l.useRef)(null);(0,l.useEffect)(()=>{a.performanceMetrics.initPerfMon();try{let e=new PerformanceObserver(t=>{for(let l of t.getEntries()){var r,n,i,o,u,c;if(l.name!==s.WF)continue;let t=performance.getEntriesByName(s.il,"measure")[0],d=performance.getEntriesByName(s.ui,"measure")[0],m=null!=(r=null==d?void 0:d.detail)?r:{};a.performanceMetrics.trackRqCacheRestore({fullRestoreMs:l.duration,restoreDelayMs:null!=(n=null==t?void 0:t.duration)?n:0,idbReadMs:null!=(i=null==d?void 0:d.duration)?i:0,preloadUsed:null!=(o=m.preload_used)&&o,cacheHit:null!=(u=m.cache_hit)&&u,queryCount:null!=(c=m.query_count)?c:0}),e.disconnect();break}});return e.observe({type:"measure",buffered:!0}),()=>e.disconnect()}catch(e){return}},[]),(0,l.useLayoutEffect)(()=>{"/new"===r||"/task/new"===r?(p.current=f.current?0:performance.now(),v.current=!1):(null==r?void 0:r.startsWith("/project/"))?(E.current=performance.now(),T.current=!1):"/settings/members"===r&&(C.current=performance.now(),x.current=!1)},[r]),(0,l.useEffect)(()=>{let e=null!==y.current&&!M.current&&!k.current,t="/new"===S.current&&(null==r?void 0:r.startsWith("/chat/"));if(e&&!t&&S.current&&null!==y.current){let e=performance.now()-y.current,t=g.current;d({event_key:"claudeai.message.streaming_abandoned",time_before_abandon_ms:Math.round(e),conversation_uuid:null==t?void 0:t.conversation_uuid,is_new_conversation:null==t?void 0:t.is_new_conversation,is_retry:null==t?void 0:t.is_retry,abandoned_from:S.current,navigated_to:r}),y.current=null,g.current=null,M.current=!1,k.current=!1}S.current=r,f.current=!1},[r,d]);let O=(0,l.useCallback)(()=>{if(v.current||null===p.current)return;v.current=!0;let e=0===p.current,{duration:t,isProgChatInput:r,progChatInputPerfMarkMissing:n}=function(e,t){let r,n=performance.getEntriesByName(m,"mark")[0],i="true"===(0,u.ul)().getItem(_),s=!1;return n&&t?(r=n.startTime,performance.clearMarks(m),(0,o.O0)()&&performance.measure("new_chat_input_ready",{start:0,end:n.startTime})):(r=performance.now()-e,i&&t&&(s=!0),(0,o.O0)()&&performance.measure("new_chat_input_ready",{start:e,duration:r})),{duration:r,isProgChatInput:i,progChatInputPerfMarkMissing:s}}(p.current,e);a.performanceMetrics.trackNewChatInputReady({duration:t,isFirstLoad:e,isProgChatInput:r,progChatInputPerfMarkMissing:n}),p.current=null},[]),P=(0,l.useCallback)(e=>{y.current=performance.now(),g.current=e,M.current=!1,k.current=!1},[]),D=(0,l.useCallback)(e=>{if(null===y.current||k.current)return;M.current=!0;let t=performance.now()-y.current,r={...g.current,model:null==e?void 0:e.model,first_content_type:null==e?void 0:e.first_content_type};w.current=null==e?void 0:e.model,a.performanceMetrics.trackTTFT(t,r)},[]),I=(0,l.useCallback)(e=>{var t,r;if(null===y.current||k.current)return;k.current=!0;let n=performance.now()-y.current,i=g.current;if(!i){y.current=null,g.current=null;return}let s=b.current;d({event_key:"claudeai.message.perceived_ttft",perceived_ttft_ms:Math.round(n),conversation_uuid:i.conversation_uuid,message_length:i.message_length,message_index:i.message_index,is_new_conversation:i.is_new_conversation,is_retry:i.is_retry,is_incognito:i.is_incognito,is_yukon_gold:i.is_yukon_gold,document_attachment_count:i.document_attachment_count,image_attachment_count:i.image_attachment_count,thinking_mode:i.thinking_mode,research_mode:i.research_mode,tool_count:i.tool_count,enabled_web_search:i.enabled_web_search,used_inline_conversation_create:i.used_inline_conversation_create,first_content_type:e.firstContentType,model:w.current,human_message_uuid:null!=(t=null==s?void 0:s.humanMessageUuid)?t:void 0,assistant_message_uuid:null!=(r=null==s?void 0:s.assistantMessageUuid)?r:void 0}),y.current=null,g.current=null,b.current=null,w.current=void 0,M.current=!1},[d]),L=(0,l.useCallback)(()=>{if(T.current||null===E.current)return;T.current=!0;let e=performance.now()-E.current;a.performanceMetrics.trackProjectConversationsReady(e),E.current=null},[]),q=(0,l.useCallback)(()=>{if(x.current||null===C.current)return;x.current=!0;let e=performance.now()-C.current;a.performanceMetrics.trackMembersListReady(e),C.current=null},[]),N=(0,l.useCallback)(e=>{b.current=e},[]),z=(0,l.useCallback)(e=>{R.current=performance.now(),A.current=e},[]),F=(0,l.useCallback)(e=>{var t;if(null===R.current)return;let r=A.current;if(!r||r.sessionId&&r.sessionId!==e)return;let n=performance.now()-R.current;R.current=null,A.current=null,n>6e4||a.performanceMetrics.trackCodeSessionOpenTime(n,{session_type:r.sessionType,is_new_session:null!=(t=r.isNewSession)&&t})},[]),j=(0,l.useMemo)(()=>({markEditorReady:O,markMessageSent:P,markFirstTokenReceived:D,setStreamStartMetadata:N,markPerceivedFirstToken:I,markProjectConversationsReady:L,markMembersListReady:q,markCodeSessionOpenStart:z,markCodeSessionOpenReady:F}),[O,P,D,N,I,L,q,z,F]);return(0,n.jsx)(h.Provider,{value:j,children:t})}function p(){let e=(0,l.useContext)(h);if(!e)throw Error("usePerformanceMetrics must be used within a PerformanceMetricsProvider");return e}},0xdbcbe18a:(e,t,r)=>{r.d(t,{D8:()=>m,Pw:()=>_,WF:()=>l,il:()=>u,ui:()=>c});var n=r(0x49fac030),i=r(0x1e8acf8e9);let s="react-query-cache",a="rq_cache:restore_start",o="rq_cache:restore_end",u="rq_cache:restore_delay",c="rq_cache:idb_read",l="rq_cache:full_restore",d=new Set([n.Rwi,n.nt7,n.Jzr,n.Gn6,n.nby,n.dZ5,n.DCQ,n.yVY,n.fCN]),m={persister:{persistClient:function(e){let{interval:t=1e3,onError:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=0,i=null,s=!1,a=!1;return async function(){for(var o=arguments.length,u=Array(o),c=0;c<o;c++)u[c]=arguments[c];if(i=u,a)return;for(a=!0;s;)await new Promise(e=>setTimeout(e,t));for(;Date.now()<n;)await new Promise(e=>setTimeout(e,n-Date.now()));a=!1,s=!0;let l=null!=i?i:[];try{await e(...l)}catch(e){try{null==r||r(e)}catch(e){}}n=Date.now()+t,s=!1}}(async e=>{let t=function(e){let t=e.clientState.queries,r=t.filter(e=>e.queryKey[0]===n.fCN);if(r.length<=3)return e;let i=t.filter(e=>e.queryKey[0]!==n.fCN);return r.sort((e,t)=>{var r,n;return(null!=(r=t.state.dataUpdatedAt)?r:0)-(null!=(n=e.state.dataUpdatedAt)?n:0)}),{...e,clientState:{...e.clientState,queries:[...i,...r.slice(0,3)]}}}(e);await (0,i.hZ)(s,t)},{interval:1e3}),restoreClient:async()=>{var e,t,r;let n;try{performance.mark(a),performance.measure(u,{start:0,end:a})}catch(e){}let l=function(){let e=window.__PRELOADED_IDB_CACHE__;return e&&(window.__PRELOADED_IDB_CACHE__=void 0),e}(),d=!1;l?(n=null!=(e=await l)?e:void 0,d=!0):n=null!=(t=await (0,i.Jt)(s))?t:void 0;try{performance.mark(o),performance.measure(c,{start:a,end:o,detail:{cache_hit:void 0!==n,query_count:null!=(r=null==n?void 0:n.clientState.queries.length)?r:0,preload_used:d}})}catch(e){}return n},removeClient:async()=>{try{await (0,i.yH)(s)}catch(e){}}},maxAge:864e5,dehydrateOptions:{shouldDehydrateQuery:function(e){let t=e.queryKey[0];return"string"==typeof t&&"success"===e.state.status&&d.has(t)}},hydrateOptions:{defaultOptions:{queries:{gcTime:864e5}}}};async function _(){try{await (0,i.yH)(s)}catch(e){}}},0x1417f52d9:(e,t,r)=>{r.d(t,{W:()=>a});var n=r(0x17aa9d8d7),i=r(0x20b939f38),s=r(0xfc89b4a4);function a(){let{mutate:e,isPending:t}=(0,n.yJ)(),{account:r}=(0,i.YL)();return{dismiss:(0,s.useCallback)(t=>{var n,i,s;r&&(null!=r&&null!=(i=r.settings)&&null!=(n=i.dismissed_claudeai_banners)&&n.some(e=>e.banner_id===t)||e({dismissed_claudeai_banners:[...(null==r||null==(s=r.settings)?void 0:s.dismissed_claudeai_banners)||[],{banner_id:t,dismissed_at:new Date().toISOString()}]}))},[r,e]),isDismissed:(0,s.useCallback)(e=>{var t,n;let i=(null==r||null==(n=r.settings)||null==(t=n.dismissed_claudeai_banners)?void 0:t.some(t=>t.banner_id===e))||!1;return"undefined"!=typeof localStorage&&i&&localStorage.removeItem(e),i},[r]),isPending:t}}}}]);