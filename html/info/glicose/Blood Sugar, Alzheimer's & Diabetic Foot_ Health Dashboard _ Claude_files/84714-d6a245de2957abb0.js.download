try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="701ea7fe-4d9e-49eb-9d77-1e0913676a04",e._sentryDebugIdIdentifier="sentry-dbid-701ea7fe-4d9e-49eb-9d77-1e0913676a04")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[84714],{0x2e37a0f7:(e,t,n)=>{n.d(t,{Oz:()=>v,fV:()=>p});var a=n(0x20b939f38),o=n(0x2252bfeb8),l=n(0x9845e38c),s=n(0xac309a83),r=n(0xfc89b4a4),i=n(0x25ffe7a2),d=n(0x1dafb1ccf),u=n(0x194a3e9dd),c=n(0xe824fb1c);async function f(e){let{enabledExtensionIds:t,filterFilesystem:n=!0}=e;if(null===o.TQ||void 0===o.TQ?void 0:o.TQ.getMcpServersConfig)try{let e=await o.TQ.getMcpServersConfig(!1);return Object.fromEntries(Object.entries(e).filter(e=>{let[a,o]=e;if(n&&o.extensionId===u.S)return!1;let l=!!o.extensionId,s=l&&t.has(o.extensionId);return!l||s}))}catch(e){l.v.error(l.u.DESKTOP_API,"Failed to fetch MCP servers",{error:e});return}}async function v(e){var t;let{enabledMcpTools:a,enabledExtensionIds:o,model:l,chromeExtCompatibleModels:s,firstPartyIntegrations:r}=e,i=(null!=(t=c.eZ.getState().localTools[d.cN])?t:[]).map(e=>e.name),u=(0,d.IV)(a,l,null!=s?s:[],i),v=await f({enabledExtensionIds:o,filterFilesystem:!0}),p=(0,c.Jy)(u);if((null==r?void 0:r.gdriveEnabled)||(null==r?void 0:r.gcalEnabled)||(null==r?void 0:r.gmailEnabled)){let{getGsuiteRemoteMcpServers:e}=await n.e(73450).then(n.bind(n,0xe33342aa)),t=e(r);p.push(...t)}return{mcpServers:v,remoteMcpServers:p,enabledMcpTools:u}}function p(e){var t;let{account:n}=(0,a.YL)(),o=(0,c.Uz)({type:"local"}),l=(0,s.fS)("suggested_connectors"),u=(0,s.fS)("suggested_plugins"),{isEnabled:f}=(0,i.a)(),v=(0,r.useMemo)(()=>{var t;let a=null==n||null==(t=n.settings)?void 0:t.enabled_mcp_tools;if(!a&&!e)return;let o={...a,...e};l||(o["local:mcp-registry:search_mcp_registry"]=!1,o["local:mcp-registry:suggest_connectors"]=!1),u&&!1!==f||(o["local:plugins:suggest_plugin_install"]=!1,o["local:plugins:search_plugins"]=!1);let s="local:".concat(d.oS,":");for(let e of Object.keys(o))e.startsWith(s)&&delete o[e];return o},[null==n||null==(t=n.settings)?void 0:t.enabled_mcp_tools,e,l,u,f]),p=(0,r.useMemo)(()=>(function(e,t){let n=new Set;if(!t)return n;for(let a of e)a.localId&&a.tools.some(e=>!1!==t[e.enabledKey])&&n.add(a.localId);return n})(o,v),[o,v]);return{enabledMcpTools:v,enabledExtensionIds:p}}},0x59fb81a1:(e,t,n)=>{n.d(t,{CX:()=>i,JY:()=>f,Kp:()=>c,Oe:()=>d,XF:()=>u,qr:()=>s});var a=n(0xb844abc8),o=n(0x9f369389),l=n(0xfc89b4a4);let s=(0,n(0x394ef833).v)((e,t)=>({vmDownloadStatus:"checking",vmDownloadProgress:0,vmDownloadError:null,vmRunningStatus:"offline",isAwaitingVMForSession:!1,setAwaitingVMForSession:t=>{e({isAwaitingVMForSession:t})},initializeClaudeVM:async n=>{if(!(null===o.EG||void 0===o.EG?void 0:o.EG.startVM))return void e({vmDownloadStatus:"ready",vmRunningStatus:"ready"});await t().startClaudeVM(n)},downloadClaudeVM:async()=>{if(!(null===o.EG||void 0===o.EG?void 0:o.EG.download))return!1;try{let n=await o.EG.download();if(!n.success){var t;e({vmDownloadError:null!=(t=n.error)?t:"Download failed"})}return n.success}catch(t){return e({vmDownloadError:t instanceof Error?t.message:"Download failed"}),!1}},startClaudeVM:async t=>{if(!(null===o.EG||void 0===o.EG?void 0:o.EG.startVM))return!1;if((0,a.uF)()&&(null===o.EG||void 0===o.EG?void 0:o.EG.checkVirtualMachinePlatform)&&!await o.EG.checkVirtualMachinePlatform())return e({vmDownloadError:"VMP_NOT_ENABLED"}),!1;e({vmDownloadError:null});try{let a=await o.EG.startVM(t);if(!a.success){var n;e({vmDownloadError:null!=(n=a.error)?n:"Startup failed"})}return a.success}catch(t){return e({vmDownloadError:t instanceof Error?t.message:"Startup failed"}),!1}}})),r=!1;function i(e){(0,l.useEffect)(()=>{if(r||void 0===e||!1===e)return;r=!0;let t=(null===o.EG||void 0===o.EG?void 0:o.EG.onDownloadStatusChanged)&&(null===o.EG||void 0===o.EG?void 0:o.EG.onRunningStatusChanged);if((null===o.EG||void 0===o.EG?void 0:o.EG.onDownloadProgress)&&o.EG.onDownloadProgress(e=>{s.setState({vmDownloadProgress:e})}),t)o.EG.onDownloadStatusChanged(e=>{s.setState({vmDownloadStatus:e,vmDownloadError:null})}),o.EG.onRunningStatusChanged(e=>{s.setState({vmRunningStatus:e,vmDownloadError:"ready"===e?null:s.getState().vmDownloadError})}),o.EG.onStartupError&&o.EG.onStartupError(e=>{s.getState().vmDownloadError||s.setState({vmDownloadError:e})}),o.EG.getDownloadStatus&&o.EG.getDownloadStatus().then(e=>{s.setState({vmDownloadStatus:e})}),o.EG.getRunningStatus&&o.EG.getRunningStatus().then(e=>{s.setState({vmRunningStatus:e,vmDownloadError:"ready"===e?null:s.getState().vmDownloadError})});else if(o.EG){let e=async()=>{try{let e=o.EG;if(e.getDownloadStatus){let t=await e.getDownloadStatus();s.setState({vmDownloadStatus:t})}if(e.getRunningStatus){let t=await e.getRunningStatus();s.setState({vmRunningStatus:t})}}catch(e){}};e(),setInterval(()=>void e(),1e3)}},[e])}let d=()=>s(e=>"ready"===e.vmDownloadStatus&&"ready"===e.vmRunningStatus);function u(){return new Promise(e=>{let t=s.getState();if("ready"===t.vmRunningStatus)return void e();"offline"===t.vmRunningStatus&&t.startClaudeVM();let n=s.subscribe(t=>{"ready"===t.vmRunningStatus&&(n(),e())})})}let c=()=>s(e=>e.isAwaitingVMForSession),f=e=>{s.getState().setAwaitingVMForSession(e)}},0xcc47f168:(e,t,n)=>{n.d(t,{G1:()=>i,RZ:()=>d,Rk:()=>r,ig:()=>o});var a=n(0x9f369389);n(0xfc89b4a4);let o=(0,n(0x394ef833).v)()(()=>({spaces:[],isInitialized:!1}));async function l(){if(!(null===a.zT||void 0===a.zT?void 0:a.zT.getAllSpaces))return void o.setState({isInitialized:!0});try{let e=await a.zT.getAllSpaces();o.setState({spaces:e,isInitialized:!0})}catch(e){o.setState({isInitialized:!0})}}let s=!1;function r(){!s&&(s=!0,l(),(null===a.zT||void 0===a.zT?void 0:a.zT.onOnSpaceEvent)&&a.zT.onOnSpaceEvent(e=>{var t,n;switch(e.type){case"created":case"updated":t=e.space,o.setState(e=>{let n=e.spaces.findIndex(e=>e.id===t.id);if(n>=0){let a=[...e.spaces];return a[n]=t,{spaces:a}}return{spaces:[...e.spaces,t]}});break;case"deleted":n=e.space.id,o.setState(e=>({spaces:e.spaces.filter(e=>e.id!==n)}))}}))}function i(e){return o(t=>e?t.spaces.find(t=>t.id===e):void 0)}function d(){return o(e=>e.isInitialized)}},0x15131d046:(e,t,n)=>{n.d(t,{p:()=>G});var a=n(0x20b939f38),o=n(0x9f369389),l=n(0xac309a83),s=n(0x1b813d90),r=n(0xfc89b4a4),i=n(0x156c4e43b),d=n(0x1d5a50fef),u=n(0x1cbe50837),c=n(0x31c535e9),f=n(0xeefd50e9),v=n(0x1dafb1ccf),p=n(0xcc47f168),g=n(0x22801240d),m=n(0x2e37a0f7),S=n(0x19d09d3a6),_=n(0x49fac030),y=n(0x12c9046cd),w=n(0x78b33fbd),b=n(0x59fb81a1),h=n(0x2252bfeb8),E=n(0x10228ff11);let x="default",D=/^[a-z0-9_]+$/;function M(){let e=(0,l.T9)("yukon_silver_config","showGsuiteConnectors",!1,i.zM()),t=(0,c.vP)("enabled_bananagrams"),n=(0,c.vP)("enabled_foccacia"),a=(0,c.vP)("enabled_sourdough"),o=(0,f.xe)(),d=o[s.v8.GDRIVE],u=o[s.v8.GMAIL],v=o[s.v8.GCAL];return(0,r.useMemo)(()=>({showGsuiteConnectorsInCowork:e,gdriveEnabled:e&&d.available&&d.enabledForOrg&&d.connected&&!!t,gcalEnabled:e&&v.available&&v.enabledForOrg&&v.connected&&!!n,gmailEnabled:e&&u.available&&u.enabledForOrg&&u.connected&&!!a}),[e,d,u,v,t,n,a])}function G(){let e=(0,c.vP)("enabled_mcp_tools"),{enabledMcpTools:t,enabledExtensionIds:n}=(0,m.fV)(e),s=(0,v.VY)(),{showGsuiteConnectorsInCowork:i,gdriveEnabled:f,gcalEnabled:G,gmailEnabled:I}=M(),T=(0,g.G)(),k=function(){let e=function(){let e=function(e){var t;let n=function(){let{activeOrganization:e,systemPrompts:t,bootstrapDataUpdatedAt:n}=(0,a.YL)(),o=(0,a.Hb)(),{data:l}=(0,y.Sk)("/api/bootstrap/".concat(o,"/system_prompts"),{queryKey:[_.V9n,o],enabled:!!e,staleTime:6e5,refetchOnWindowFocus:!0,initialData:null!=t?t:void 0,initialDataUpdatedAt:t?n:void 0,meta:{noToast:!0}});return null!=l?l:t}();return null==n||null==(t=n[e])?void 0:t.value}("cowork_system_prompt");if(e&&"object"==typeof e){var t;return null!=(t=e.prompt)?t:""}return""}(),t=function(){let e=(0,w.useDynamicConfig)("office_addin_key_for_system_prompt").get("key",x),t=(0,r.useMemo)(()=>"string"==typeof e&&D.test(e)?e:x,[e]),n="".concat("office_addin_system_prompt_").concat(t);return(0,w.useDynamicConfig)(n).get("prompt","")}(),n=function(){let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(null===h.W$||void 0===h.W$?void 0:h.W$.getPreferences)&&h.W$.getPreferences().then(e=>{var n;t(null!=(n=null==e?void 0:e.louderPenguinEnabled)&&n)})},[]),e}(),{gdriveEnabled:o,gcalEnabled:l,gmailEnabled:s}=M(),i=function(e){let{gdriveEnabled:t,gcalEnabled:n,gmailEnabled:a}=e,o=(0,w.useDynamicConfig)("gsuite_system_prompt"),l=o.get("gdrive_prompt",""),s=o.get("gcal_prompt",""),i=o.get("gmail_prompt","");return(0,r.useMemo)(()=>{let e=[];return t&&l&&e.push(l),n&&s&&e.push(s),a&&i&&e.push(i),e.join("\n\n")},[t,l,n,s,a,i])}({gdriveEnabled:o,gcalEnabled:l,gmailEnabled:s}),{data:u}=(0,d.mw)(),c=null==u?void 0:u.conversation_preferences;return(0,r.useMemo)(()=>{let a=e;if(i&&(a=a?"".concat(a,"\n\n").concat(i):i),n&&t&&(a=a?"".concat(a,"\n\n").concat(t):t),c){let e="<user_preferences>\nThe user has specified the following personal preferences for how Claude should respond:\n\n".concat(c,"\n\nPlease keep these preferences in mind when responding.\n</user_preferences>");a=a?"".concat(a,"\n\n").concat(e):e}return a},[e,t,n,i,c])}(),{model:P}=(0,E.k)(),F=(0,S.p)(),{data:C}=(0,u.Kp)(),{account:V}=(0,a.YL)(),R=(0,l.fS)("cowork_otlp");return(0,r.useCallback)(async e=>{var a,l,r,d;if(!(null===o.Fd||void 0===o.Fd?void 0:o.Fd.start))return;(0,b.JY)(!0);try{await (0,b.XF)()}finally{(0,b.JY)(!1)}let u=null!=(a=e.model)?a:P,{mcpServers:c,remoteMcpServers:v,enabledMcpTools:g}=await (0,m.Oz)({enabledMcpTools:null!=(l=e.enabledMcpTools)?l:t,enabledExtensionIds:n,model:u,chromeExtCompatibleModels:s,firstPartyIntegrations:i?{gdriveEnabled:f,gcalEnabled:G,gmailEnabled:I,toolDescriptionOverrides:T}:void 0}),S=k;if(e.spaceId){let t=p.ig.getState().spaces.find(t=>t.id===e.spaceId);if(null==t?void 0:t.instructions){let e='<space_instructions>\nThe user has configured the following instructions for this space ("'.concat(t.name,'"):\n\n').concat(t.instructions,"\n\nFollow these instructions when working in this space.\n</space_instructions>");S=S?"".concat(S,"\n\n").concat(e):e}}e.systemPromptSuffix&&(S="".concat(S,"\n\n").concat(e.systemPromptSuffix));let _=await o.Fd.start({message:e.message,sessionId:e.sessionId,model:u,systemPrompt:S,mcpServers:c,remoteMcpServers:v,enabledMcpTools:g,userSelectedFiles:e.userSelectedFiles,userSelectedFolders:e.userSelectedFolders,egressAllowedDomains:F.validEgressAllowedDomains,messageUuid:e.messageUuid,images:e.images,title:e.title,accountName:null!=(r=null==V?void 0:V.display_name)?r:null==V?void 0:V.full_name,emailAddress:null==V?void 0:V.email_address,userSelectedProjectUuids:e.userSelectedProjectUuids,scheduledTaskId:e.scheduledTaskId,channel:e.channel,spaceId:e.spaceId,sessionType:e.sessionType,otelConfig:R&&(null==C?void 0:C.otlp_endpoint)&&(null==C?void 0:C.otlp_protocol)?{endpoint:C.otlp_endpoint,protocol:C.otlp_protocol,headers:null!=(d=C.otlp_headers)?d:void 0}:void 0});if(null==_?void 0:_.sessionId)return{sessionId:_.sessionId}},[null==V?void 0:V.display_name,null==V?void 0:V.email_address,null==V?void 0:V.full_name,k,n,t,P,s,F,R,null==C?void 0:C.otlp_endpoint,null==C?void 0:C.otlp_protocol,null==C?void 0:C.otlp_headers,i,f,G,I,T])}},0x165341f8a:(e,t,n)=>{n.d(t,{J:()=>w,V:()=>b});var a=n(0xf32c56dd),o=n(0x9f369389),l=n(0xe670e093),s=n(0x4d348f95),r=n(0xfc89b4a4),i=n(0xbdad302d),d=n(0x241c4325a),u=n(0x1449f94a5),c=n(0x10228ff11),f=n(0x15d264a53),v=n(0x21687185c);let p="has_started_cowork_conversation";var g=n(0x2a8b4170),m=n(0xe6c3f31e),S=n(0xe41b440d),_=n(0x15131d046),y=n(0x1b09c791a);let w=new Set;function b(e){let t=null==e?void 0:e.spaceId,n=(0,s.useRouter)(),b=(0,v.jT)(),h=(0,i._Y)(),E=(0,y._S)(),{track:x}=(0,a.st)(),{data:D}=(0,d.Fj)(),M=(0,r.useMemo)(()=>D.map(e=>e.name),[D]),{model:G}=(0,c.k)(),I=(0,_.p)();return(0,r.useCallback)(async(e,a,s,r,d,c)=>{let{selectedFolders:v=[],selectedProjectUuids:_,clearProjects:y}=S.i.getState(),D=!E.loading&&E.enabled?Array.from(null!=_?_:[]):[],T=(0,i.Ey)(e,null!=r?r:[],null!=d?d:[]),k=(null!=r?r:[]).map(e=>e.localPath).filter(e=>!!e),P=(0,l.b)(),F=c?(0,g.r)(c):void 0,C=T.trim().length>=10,V=C?h.mutateAsync({first_session_message:T}).catch(()=>void 0):Promise.resolve(void 0),R=f.PU.getState().sessions.length,z=await I({message:T,model:null!=s?s:G,title:void 0,userSelectedFiles:k.length>0?k:void 0,userSelectedFolders:v.length>0?v:void 0,messageUuid:P,images:F,userSelectedProjectUuids:D.length>0?D:void 0,spaceId:t});if(!z)return;let{sessionId:A}=z;C&&(w.add(A),V.then(e=>{w.delete(A),(null==e?void 0:e.title)&&(null===o.Fd||void 0===o.Fd?void 0:o.Fd.updateSession)&&o.Fd.updateSession(A,{title:e.title})}));let O=(0,i.I5)(T,A,P);return b(A,O),t||y(),x({event_key:"claudeai.yukon_gold.session_created",session_type:"local",session_id:A,files_selected:k.length,folders_selected:v.length,projects_attached:D.length,space_id:t}),function(e){try{if("true"===localStorage.getItem(p)||(localStorage.setItem(p,"true"),e>0))return!1;return!0}catch(e){return!1}}(R)&&x({event_key:"cowork.first_conversation.started"}),(0,m.q6)({message:T,sessionId:A,track:x,knownCommands:M}),n.push("".concat(u.fM,"/").concat(A)),A},[b,G,x,M,n,E,h,I,t])}},0x1d5a50fef:(e,t,n)=>{n.d(t,{Ap:()=>u,jC:()=>d,jS:()=>r,mw:()=>i});var a=n(0x12c9046cd),o=n(0x20b939f38),l=n(0x49fac030),s=n(0x17e725145);function r(){var e;let t=(0,o.YL)();return(0,a.Sk)("/api/account/deletion-allowed",{queryKey:[l.wak,null==t||null==(e=t.account)?void 0:e.uuid],staleTime:0})}function i(e){return(0,a.Sk)("/api/account_profile",{queryKey:[l.nt7],...e})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.useQueryClient)();return(0,a.L2)("/api/account_profile","PUT",{...e,onSuccess:(n,a,o)=>{var s;t.invalidateQueries({queryKey:[l.nt7]}),null==(s=e.onSuccess)||s.call(e,n,a,o)}})}function u(){let e=(0,s.useQueryClient)();return(0,a.L2)("/api/account/grove_notice_viewed","POST",{onSuccess:()=>{e.invalidateQueries({queryKey:[l.Rwi]})}})}}}]);